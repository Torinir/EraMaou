;---------------------------------------------------------
@CHAR_MAKE, ARG:0 = 0, ARG:1 = 0
#DIM PREG_EXP
#DIM FAMILY_ID
#DIM FAMILY_TARGET
#DIM HAIR_COLOR
#DIM CHARA
#DIM DICE
;---------------------------------------------------------
;ARG:0	性格設定
;	160,慈愛　161,自信家　162,気弱　163,高貴　164,冷徹　165,村娘Ａ;マオ専用性格、ユニーク
;	166,悪女　167,ハート;ユニーク　168,スペード;ユニーク　169,ダイヤ;ユニーク　170,クラブ;ユニーク
;	171,村娘Ｂ;リリィ専用性格、ユニーク　172,知的　173,庇護者,
;ARG:1	種族設定

;	12：人間　1：エルフ　2：人狼　3：吸血鬼　4：デュラハン　5：ドラゴン
;	6：天使　7：ダークエルフ　8：堕天使　9：魔族　10：ホビット　11：ドワーフ

;ARG:0～ARG:1=999の場合、設定済み
;ARG:0 = 998 の時、ARG:1の確定家族

CHARA = A
FAMILY_TARGET = 0

SIF ARG:1 == 999
	ARG:1 = TALENT:CHARA:種族

IF ARG:0 == 998
	FAMILY_TARGET = ARG:1
	ARG:0 = 0
	ARG:1 = 0
ENDIF

;共通初期値

;レベル・経験値設定
CFLAG:CHARA:9 = 1
EXP:CHARA:80 = 0

;侵入階層・侵攻度・侵攻中・再起ポイント設定
CFLAG:CHARA:501 = 1
CFLAG:CHARA:502 = 0
CFLAG:CHARA:1 = 2
CFLAG:CHARA:508 = 3

;家族初期化
CFLAG:CHARA:605 = 0

;売春への積極性
CFLAG:CHARA:120 = 1

;男子の可能性
GETBIT FLAG:8,0
SIF RAND:20 == 0 && RESULT == 1
	TALENT:CHARA:122 = 1

;初心者の烙印
SIF DAY:0 <= 60
	TALENT:CHARA:291 = 1

;職ごとの基礎パラメーター

IF TALENT:CHARA:200 == 1 || TALENT:CHARA:205 == 1
	;戦士&騎士
	CFLAG:CHARA:11 = 20
	CFLAG:CHARA:12 = 20
	CFLAG:CHARA:13 = 20
	CFLAG:CHARA:14 = 20
ELSEIF TALENT:CHARA:201 == 1 || TALENT:CHARA:206 == 1
	;魔術師&巫女
	CFLAG:CHARA:11 = 15
	CFLAG:CHARA:12 = 15
	CFLAG:CHARA:13 = 15
	CFLAG:CHARA:14 = 15
ELSEIF TALENT:CHARA:202 == 1 || TALENT:CHARA:207 == 1
	;神官&忍者
	CFLAG:CHARA:11 = 15
	CFLAG:CHARA:12 = 20
	CFLAG:CHARA:13 = 15
	CFLAG:CHARA:14 = 20
ELSEIF TALENT:CHARA:203 == 1 || TALENT:CHARA:208 == 1
	;盗賊&弓師
	CFLAG:CHARA:11 = 20
	CFLAG:CHARA:12 = 15
	CFLAG:CHARA:13 = 20
	CFLAG:CHARA:14 = 15
ELSE
	;その他
	CFLAG:CHARA:11 = 15
	CFLAG:CHARA:12 = 15
	CFLAG:CHARA:13 = 15
	CFLAG:CHARA:14 = 15
ENDIF

;神官と巫女は治癒を持つ
;戦士と騎士は鼓舞を持つ
IF TALENT:CHARA:202 == 1 || TALENT:CHARA:206 == 1
	TALENT:CHARA:117 = 1
	;高い信仰値を持つ
	CFLAG:CHARA:152 = 20
ELSEIF TALENT:CHARA:200 == 1 || TALENT:CHARA:205 == 1
	TALENT:CHARA:118 = 1
ENDIF

;性格設定
;エルフの領域、天界、ドラゴンの山のクリアフラグ
IF ARG:0 == 999
	;すでに設定されている
ELSEIF ARG:0
	TALENT:CHARA:(ARG:0) = 1
ELSE
	$CHARA_MIND_LOOP
	DICE = RAND:9 + 160

	;ユニークは除外
	SIF DICE == 165
		GOTO CHARA_MIND_LOOP
	
	SIF DICE >= 167
		DICE += 5
	
	IF TALENT:CHARA:122 == 1
		DICE = 174
	ENDIF
	
	TALENT:CHARA:DICE = 1
ENDIF


;処女フラグ
IF TALENT:CHARA:122 == 1
	TALENT:CHARA:0 = 0
	;童貞
	IF RAND:3 > 0
		TALENT:CHARA:1 = 1
		CFLAG:CHARA:15 = -1
		CFLAG:CHARA:16 = -1
	ELSE
		CFLAG:CHARA:15 = 0
		CFLAG:CHARA:16 = 0
	ENDIF
ELSEIF FLAG:82 == 1 && RAND:2 == 0
	TALENT:CHARA:0 = 1
	CFLAG:CHARA:16 = -1
ELSEIF RAND:8
	TALENT:CHARA:0 = 1
	CFLAG:CHARA:16 = -1
ENDIF
;処女の場合ファーストキスはまだ
SIF TALENT:CHARA:0 == 1
	CFLAG:CHARA:16 = -1

;処女の場合ランダムで貞操封印を行う
SIF TALENT:CHARA:0 == 1 && RAND:5 == 0
	TALENT:CHARA:273 = 1

;160,慈愛,
;161,自信家,
;162,気弱,
;163,高貴,
;164,冷徹,
;166,悪女,

;10,臆病,;ABL:従順が上げやすい.PALAM:反感が上がりにくい
;12,気丈,;コマンドを実行しにくい.売却の際に従順4以上必要
;14,大人しい,;PALAM:反感が上がりにくい
DICE = RAND:3
;慈愛か気弱だと臆病
IF DICE == 0 && (TALENT:CHARA:160 == 1 || TALENT:CHARA:162 == 1)
	TALENT:CHARA:10 = 1
;自信家か高貴か冷徹か悪女だと気丈
ELSEIF DICE == 1  && (TALENT:CHARA:161 == 1 || TALENT:CHARA:163 == 1 || TALENT:CHARA:164 == 1 || TALENT:CHARA:166 == 1)
	TALENT:CHARA:12 = 1
;慈愛か気弱だと大人しい
ELSEIF DICE == 2 && (TALENT:CHARA:160 == 1 || TALENT:CHARA:162 == 1)
	TALENT:CHARA:14 = 1
ENDIF

;11,反抗的,;コマンドを実行しにくい.売却の際に従順4以上必要.PALAM:恭順と欲情が上がりにくい
;13,素直,;コマンドを実行しやすい.ABL:従順と奉仕精神が上げやすい.PALAM:恭順が上がりやすい
;16,生意気,;ABL:従順と奉仕精神が上げにくい.
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:11 = 1
	;反抗的だと一定確率でツンデレる
	SIF RAND:8 == 0
		TALENT:CHARA:18 = 1
ELSEIF DICE == 1
	TALENT:CHARA:13 = 1
;自信家か高貴か冷徹か悪女だと生意気
ELSEIF DICE == 2 && (TALENT:CHARA:161 == 1 || TALENT:CHARA:163 == 1 || TALENT:CHARA:164 == 1 || TALENT:CHARA:166 == 1)
	TALENT:CHARA:16 = 1
ENDIF

;15,プライド高い,;コマンドを実行しにくい.ABL:技巧と奉仕精神が上げにくい.PALAM:屈服が上がりにくい
;17,プライド低い,;コマンドを実行しやすい.ABL:奉仕精神が上げやすい.PALAM:屈服が上がりやすい
;18,ツンデレ,;反抗的を同時に持つ場合、従順4以上で反抗的→素直に変更
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:15 = 1
ELSEIF DICE == 1 && TALENT:CHARA:18 == 0
	TALENT:CHARA:17 = 1
ELSEIF DICE == 2 && TALENT:CHARA:18 == 0
	TALENT:CHARA:18 = 1
ENDIF

;20,自制心,;売却の際に欲望4以上必要.ABL:奉仕精神が上げにくい.快楽系PALAMが上がりにくい
;21,無関心,:ABL:奉仕精神が上げにくい.PALAM:恭順、欲情、屈服、恐怖、反感が上がりにくい
;22,感情乏しい,:ABL:奉仕精神が上げにくい.PALAMが全体的に上がりにくい
;23,好奇心,;コマンドを実行しやすい.PALAM:習得が上がりやすい
;63,献身的,;奉仕系調教を実行しやすい.ABL:奉仕精神が上げやすい.PALAM:屈服が上がりやすい
DICE = RAND:16
IF DICE == 0
	TALENT:CHARA:21 = 1
ELSEIF DICE == 1
	TALENT:CHARA:23 = 1
ELSEIF DICE == 2
	TALENT:CHARA:22 = 1
ELSEIF DICE == 3
	TALENT:CHARA:20 = 1
ELSEIF DICE == 4
	TALENT:CHARA:63 = 1
ENDIF

;24,保守的,;コマンドを実行しにくい.ABL:奉仕精神が上げにくい.PALAM:習得が上がりにくい
;25,楽観的,;ABL:奉仕精神が上げやすい.PALAM:抑鬱が上がりにくい
;26,悲観的,;ABL:奉仕精神が上げやすい.PALAM:抑鬱が上がりやすい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:24 = 1
ELSEIF DICE == 1
	TALENT:CHARA:25 = 1
ELSEIF DICE == 2
	TALENT:CHARA:26 = 1
ENDIF

;27,一線越えない,;全てのABLが上げにくい
;28,目立ちたがり,;コマンドを実行しやすい.ABL:露出癖が上げやすい
DICE = RAND:8
IF DICE == 0
	TALENT:CHARA:27 = 1
ELSEIF DICE == 1
	TALENT:CHARA:28 = 1
ENDIF

;30,貞操観念,;情愛系調教の効果が低い.PALAM:反感が上がりやすい
;31,貞操無頓着,;情愛系調教の効果が低い.PALAM:反感が上がりにくい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:30 = 1
ELSEIF DICE == 1
	TALENT:CHARA:31 = 1
ENDIF

;32,抑圧,;コマンドを実行しにくい.売却の際に欲望4以上必要.PALAM:欲情が上がりにくい.PALAM:反感が上がりやすい
;33,解放,;ABL:マゾっ気とABL:レズっ気が上げやすい.PALAM:欲情と屈服が上がりやすい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:32 = 1
ELSEIF DICE == 1
	TALENT:CHARA:33 = 1
ENDIF

;34,抵抗,;コマンドを実行しにくい.売却の際に欲望4以上必要.PALAM:欲情が上がりにくい.PALAM:反感が上がりやすい
SIF RAND:12 == 0
	TALENT:CHARA:34 = 1

;35,恥じらい,;コマンドを実行しにくい.露出系調教の効果が高い
;36,恥薄い,;露出系調教の効果が低い
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:35 = 1
ELSEIF DICE == 1
	TALENT:CHARA:36 = 1
ENDIF

;37,弱味,;コマンドを実行しやすい
SIF RAND:8 == 0
	TALENT:CHARA:37 = 1

;40,痛みに弱い,;PALAM:恐怖と反感が上がりやすい.ABL:マゾっ気があるとSM系調教でPALAM:欲情が上がりやすい
;41,痛みに強い,;PALAM:恐怖と反感が上がりにくい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:40 = 1
ELSEIF DICE == 1
	TALENT:CHARA:41 = 1
ENDIF

;42,濡れやすい,;PALAM:潤滑が上がりやすい
;43,濡れにくい,;PALAM:潤滑が上がりにくい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:42 = 1
ELSEIF DICE == 1
	TALENT:CHARA:43 = 1
ENDIF

;48,近視,;眼鏡が似合う
SIF RAND:12 == 0
	TALENT:CHARA:48 = 1

;50,習得早い,;ABL:奉仕精神が上げやすい.PALAM:習得が上がりやすい
;51,習得遅い,;ABL:奉仕精神が上げにくい.PALAM:習得が上がりにくい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:50 = 1
ELSEIF DICE == 1
	TALENT:CHARA:51 = 1
ENDIF

;52,舌使い,;フェラ系調教の効果が高い
SIF RAND:8 == 0
	TALENT:CHARA:52 = 1

;57,おもらし癖,;放尿コマンドが常に使えるようになる.絶頂時に放尿.
SIF RAND:50 == 0
	TALENT:CHARA:57 = 1

;60,自慰しやすい,;自慰関連が実行しやすい.ABL:自慰中毒が上げやすい
SIF RAND:8 == 0
	TALENT:CHARA:60 = 1

;61,汚臭鈍感,;フェラ系調教を実行しやすい.ABL:精液中毒が上げやすい
;62,汚臭敏感,;フェラ系調教を実行しにくい.ABL:精液中毒が上げにくい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:61 = 1
ELSEIF DICE == 1
	TALENT:CHARA:62 = 1
ENDIF


;70,快感に素直,;コマンドを実行しやすい.ABL:欲望と奉仕精神が上げやすい.PALAM:欲情が上がりやすい
;71,快感の否定,;コマンドを実行しにくい.PALAM:欲情が上がりにくい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:70 = 1
ELSEIF DICE == 1
	TALENT:CHARA:71 = 1
ENDIF

;72,中毒しやすい,;ABL:自慰中毒、精液中毒、レズ中毒が上げやすい
SIF RAND:8 == 0
	TALENT:CHARA:72 = 1

;即落ち頻度はここを弄ってください
SIF RAND:30 == 0
	TALENT:CHARA:73 = 1

;80,倒錯的,;SM系調教の効果が高い.ABLが全体的に上がりやすい
SIF RAND:8 == 0
	TALENT:CHARA:80 = 1

;81,両刀,;レズ調教を実行しやすい.ABL:レズ、レズ中毒が上げやすい
;82,男嫌い,;オトコによる調教が実行しにくい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:81 = 1
ELSEIF DICE == 1
	TALENT:CHARA:82 = 1
ENDIF

;20,サドっ気
;21,マゾっ気
DICE = RAND:8
IF DICE == 0
	ABL:CHARA:20 = 3
ELSEIF DICE == 1
	ABL:CHARA:21 = 3
ENDIF

;84,嫉妬,;いるだけで他のキャラの回復量減少.効果は累積する
SIF RAND:10 == 0
	TALENT:CHARA:84 = 1

;87,小悪魔,;調教者の時にコマンドを実行しやすい
SIF RAND:8 == 0
	TALENT:CHARA:87 = 1

;17,露出癖
SIF RAND:40 == 0
	ABL:CHARA:17 = 3

;91,魅惑,;調教者の時にコマンドを実行しやすい.調教者の時にPALAMが全体的に上がりやすい
SIF RAND:20 == 0
	TALENT:CHARA:91 = 1

;99,大柄,;PALAM:苦痛、恐怖が上がりにくい
;100,小柄体型,;PALAM:苦痛、恐怖が上がりやすい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:99 = 1
ELSEIF DICE == 1
	TALENT:CHARA:100 = 1
ENDIF

;101,Ｃ鈍感,;PALAM:快Ｃが上がりにくい
;102,Ｃ敏感,;PALAM:快Ｃが上がりやすい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:101 = 1
ELSEIF DICE == 1
	TALENT:CHARA:102 = 1
ENDIF

;103,Ｖ鈍感,;PALAM:快Ｖが上がりにくい
;104,Ｖ敏感,;PALAM:快Ｖが上がりやすい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:103 = 1
ELSEIF DICE == 1
	TALENT:CHARA:104 = 1
ENDIF

;105,Ａ鈍感,;PALAM:快Ａが上がりにくい
;106,Ａ敏感,;PALAM:快Ａが上がりやすい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:105 = 1
ELSEIF DICE == 1
	TALENT:CHARA:106 = 1
ENDIF

;107,Ｂ鈍感,;PALAM:快Ｂが上がりにくい
;108,Ｂ敏感,;PALAM:快Ｂが上がりやすい
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:107 = 1
ELSEIF DICE == 1
	TALENT:CHARA:108 = 1
ENDIF

;119,超乳,;[爆乳]の上位コンパチ
;114,爆乳,;[巨乳]の上位コンパチ
;116,絶壁,;[貧乳]の上位(下位？)コンパチ
;109,貧乳,;ABL:Ｂ感覚が上げやすい.胸関連の調教にペナルティ
;110,巨乳,;ABL:Ｂ感覚が上げにくい.胸関連の調教にボーナス
IF RAND:50 == 0 && TALENT:CHARA:122 == 0
	TALENT:CHARA:119 = 1
ELSEIF RAND:25 == 0 && TALENT:CHARA:122 == 0
	TALENT:CHARA:114 = 1
ELSEIF RAND:24 == 0 && TALENT:CHARA:122 == 0
	TALENT:CHARA:116 = 1
ELSEIF RAND:8 == 0 && TALENT:CHARA:122 == 0
	TALENT:CHARA:109 = 1
ELSEIF RAND:7 == 0 && TALENT:CHARA:122 == 0
	TALENT:CHARA:110 = 1
ENDIF

;111,回復早い,;体力回復量が多い
;112,回復遅い,;体力回復量が少ない
DICE = RAND:12
IF DICE == 0
	TALENT:CHARA:111 = 1
ELSEIF DICE == 1
	TALENT:CHARA:112 = 1
ENDIF

;113,魅力,;売却額増加
SIF RAND:8 == 0
	TALENT:CHARA:113 = 1

;121,ふたなり,;オトコでなくてもSEX系調教が可能
IF RAND:80 == 0 && TALENT:CHARA:122 == 0
	TALENT:CHARA:121 = 1
	TALENT:CHARA:1 = 1
ENDIF

;v0.350追加
;140～143,各種コンプレックス,：調教効果が変わる
IF TALENT:CHARA:オトコ
	;オトコの場合マザコンロリコンが多い
	IF RAND:25 == 0
		TALENT:CHARA:マザコン = 1
	ELSEIF RAND:24 == 0
		TALENT:CHARA:ロリコン = 1
	ELSEIF RAND:40 == 0
		TALENT:CHARA:ファザコン = 1
	ELSEIF RAND:39 == 0
		TALENT:CHARA:ショタコン = 1
	ENDIF
ELSEIF TALENT:CHARA:ふたなり
	;ふたなりの場合ニュートラル
	IF RAND:30 == 0
		TALENT:CHARA:マザコン = 1
	ELSEIF RAND:29 == 0
		TALENT:CHARA:ロリコン = 1
	ELSEIF RAND:28 == 0
		TALENT:CHARA:ファザコン = 1
	ELSEIF RAND:27 == 0
		TALENT:CHARA:ショタコン = 1
	ENDIF
ELSE
	;それ以外の場合ファザコンショタコンが多い
	IF RAND:25 == 0
		TALENT:CHARA:ファザコン = 1
	ELSEIF RAND:24 == 0
		TALENT:CHARA:ショタコン = 1
	ELSEIF RAND:40 == 0
		TALENT:CHARA:マザコン = 1
	ELSEIF RAND:39 == 0
		TALENT:CHARA:ロリコン = 1
	ENDIF
ENDIF

;157,人妻,;欲望が上がりやすくなります
IF RAND:12 == 0 && TALENT:CHARA:122 == 0
	TALENT:CHARA:157 = 1
	TALENT:CHARA:0 = 0
ENDIF

;290,保証人,;借金が増えていきます
IF TALENT:CHARA:37 && RAND:4 == 0
	;弱味があると保証人である確率が高いです
	TALENT:CHARA:290 = 1
ELSEIF RAND:12 == 0
	TALENT:CHARA:290 = 1
ENDIF

;カルマ
CFLAG:CHARA:151 = RAND:200

;戦闘技能
;戦術;LVUP時にステータスにボーナス
SIF RAND:40 == 0
	TALENT:CHARA:240 = 1
;魔術;魔法を使用できる
SIF RAND:40 == 0
	TALENT:CHARA:241 = 1
;法術;回復魔法を使用できる.また信仰の証
SIF RAND:40 == 0
	TALENT:CHARA:242 = 1
;奇襲;先手確率UP・先手時に攻撃にボーナス
SIF RAND:40 == 0
	TALENT:CHARA:243 = 1

;筋肉質・虚弱
IF RAND:30 == 0
	TALENT:CHARA:248 = 1
ELSEIF RAND:29 == 0
	TALENT:CHARA:256 = 1
ENDIF

;鉄壁;ピンチ時にステータス回復
SIF RAND:40 == 0
	TALENT:CHARA:249 = 1
;呪術;呪術系魔法を使用できる
SIF RAND:40 == 0
	TALENT:CHARA:250 = 1
;忍術;攻撃をたまに回避できる
SIF RAND:40 == 0
	TALENT:CHARA:251 = 1
;先制;戦闘前に追加攻撃
SIF RAND:40 == 0
	TALENT:CHARA:252 = 1

;褐色とか白皙とか
IF RAND:12 == 0
	TALENT:CHARA:253 = 1
ELSEIF RAND:11 == 0
	TALENT:CHARA:255 = 1
ENDIF

;魔法耐性
SIF RAND:40 == 0
	TALENT:CHARA:257 = 1
;俊足
SIF RAND:40 == 0
	TALENT:CHARA:258 = 1

;隻眼とか額の眼とか
IF RAND:60 == 0
	TALENT:CHARA:259 = 1
ELSEIF RAND:59 == 0
	TALENT:CHARA:260 = 1
ENDIF

;能力者技能

;火の能力者
SIF RAND:40 == 0
	TALENT:CHARA:275 = 1
;氷の能力者
SIF RAND:40 == 0
	TALENT:CHARA:276 = 1
;雷の能力者
SIF RAND:40 == 0
	TALENT:CHARA:277 = 1
;光の能力者
SIF RAND:40 == 0
	TALENT:CHARA:278 = 1
;闇の能力者
SIF RAND:40 == 0
	TALENT:CHARA:279 = 1

;額の目の場合、闇チャンス2回目
SIF TALENT:CHARA:260 == 1 && RAND:40 == 0
	TALENT:CHARA:279 = 1

TARGET = CHARA
CALL LOOK_SET, ARG:1
TARGET = -1

;パイパン
IF RAND:20 == 0
	TALENT:CHARA:125 = 1
	TALENT:CHARA:310 = 1
	TALENT:CHARA:311 = 1
ENDIF

;名前の設定
IF TALENT:CHARA:122
	;男子はランダムネーム
	;そのうち洋名和名も追加したい
	CALL RANDOM_NAME,3, CHARA
ELSE
	CALL RANDOM_NAME,0, CHARA
ENDIF

;家族設定
;設定に名前を使用するので、家族設定より先に
;名前を設定しておくこと
IF RAND:10 == 0 && FAMILY_TARGET == 0
	CALL SET_FAMILY_LINK, CHARA, FAMILY_TARGET
ELSEIF FAMILY_TARGET > 0
	CALL SET_FAMILY_LINK, CHARA, FAMILY_TARGET
ENDIF

IF FLAG:60 > 0 && FLAG:402 == 0
	REPEAT FLAG:60
		CALL ST_UP, CHARA
	REND
ENDIF
BASE:CHARA:0 = MAXBASE:CHARA:0
BASE:CHARA:1 = MAXBASE:CHARA:1

;家族の身体的特徴が遺伝
LOCAL = CFLAG:CHARA:605
LOCAL:1 = LOCAL % 10
CALL SEARCH_FAMILY, CHARA
FAMILY_ID = RESULT

IF FAMILY_ID > 0
	;家族が15歳未満
	IF CFLAG:FAMILY_ID:451 < 15
		;大柄なら体格を一段階大さくする
		IF TALENT:FAMILY_ID:大柄 && RAND:3 == 0
			IF TALENT:CHARA:小柄体型
				TALENT:CHARA:小柄体型 = 0
			ELSE
				TALENT:CHARA:大柄 = 1
			ENDIF
		ENDIF

		;巨乳以上なら乳を一段階大さくする
		IF ((TALENT:FAMILY_ID:巨乳 && RAND:4) || (TALENT:FAMILY_ID:爆乳 && RAND:2) || (TALENT:FAMILY_ID:超乳) == 0) && TALENT:CHARA:122 == 0
			IF TALENT:CHARA:絶壁
				TALENT:CHARA:絶壁 = 0
				TALENT:CHARA:貧乳 = 1
			ELSEIF TALENT:CHARA:貧乳
				TALENT:CHARA:貧乳 = 0
			ELSEIF (TALENT:CHARA:巨乳 == 0 && TALENT:CHARA:爆乳 == 0 && TALENT:CHARA:超乳 == 0)
				TALENT:CHARA:巨乳 = 1
			ELSEIF TALENT:CHARA:巨乳
				TALENT:CHARA:巨乳 = 0
				TALENT:CHARA:爆乳 = 1
			ELSE
				TALENT:CHARA:爆乳 = 0
				TALENT:CHARA:超乳 = 1
			ENDIF
		ENDIF
	;家族が18歳以上
	ELSEIF CFLAG:FAMILY_ID:451 > 17
		;小柄体型なら体格を一段階小さくする
		IF TALENT:FAMILY_ID:小柄体型 && RAND:3 == 0
			IF TALENT:CHARA:大柄
				TALENT:CHARA:大柄 = 0
			ELSE
				TALENT:CHARA:小柄体型 = 1
			ENDIF
		ENDIF

		;貧乳以下なら階乳を一段小さくする
		IF ((TALENT:FAMILY_ID:貧乳 && RAND:4) || (TALENT:FAMILY_ID:絶壁 && RAND:2) == 0) && TALENT:CHARA:122 == 0
			IF TALENT:CHARA:超乳
				TALENT:CHARA:超乳 = 0
				TALENT:CHARA:爆乳 = 1
			ELSEIF TALENT:CHARA:爆乳
				TALENT:CHARA:爆乳 = 0
				TALENT:CHARA:巨乳 = 1
			ELSEIF TALENT:CHARA:巨乳
				TALENT:CHARA:巨乳 = 0
			ELSEIF (TALENT:CHARA:貧乳 == 0 && TALENT:CHARA:絶壁 == 0)
				TALENT:CHARA:貧乳 = 1
			ELSE
				TALENT:CHARA:貧乳 = 0
				TALENT:CHARA:絶壁 = 1
			ENDIF
		ENDIF
	ENDIF

	IF (TALENT:FAMILY_ID:筋肉質 || TALENT:FAMILY_ID:虚弱) && RAND:3 == 0
		TALENT:CHARA:筋肉質 = TALENT:FAMILY_ID:筋肉質
		TALENT:CHARA:虚弱 = TALENT:FAMILY_ID:虚弱
	ENDIF

	IF (TALENT:FAMILY_ID:褐色肌 || TALENT:FAMILY_ID:白皙) && RAND:2 == 0
		TALENT:CHARA:褐色肌 = TALENT:FAMILY_ID:褐色肌
		TALENT:CHARA:白皙 = TALENT:FAMILY_ID:白皙
	ENDIF

	SIF TALENT:FAMILY_ID:額の眼 && RAND:3 == 0
		TALENT:CHARA:額の眼 = TALENT:FAMILY_ID:額の眼

	;家族と"近い色」の髪になる可能性が高い
	;銀 金 赤 栗 緑 青 黒の順
	IF RAND:5 != 0
		IF TALENT:FAMILY_ID:髪の色 == 1
			HAIR_COLOR =120
		ELSEIF TALENT:FAMILY_ID:髪の色 == 2
			HAIR_COLOR =140
		ELSEIF TALENT:FAMILY_ID:髪の色 == 3
			HAIR_COLOR =170
		ELSEIF TALENT:FAMILY_ID:髪の色 == 4
			HAIR_COLOR =130
		ELSEIF TALENT:FAMILY_ID:髪の色 == 5
			HAIR_COLOR =110
		ELSEIF TALENT:FAMILY_ID:髪の色 == 6
			HAIR_COLOR =160
		ELSEIF TALENT:FAMILY_ID:髪の色 == 7
			HAIR_COLOR =150
		ENDIF
		HAIR_COLOR = HAIR_COLOR - 20 + RAND:9 + RAND:9 + RAND:9 + RAND:9 + RAND:9
		IF HAIR_COLOR > 170
			TALENT:CHARA:髪の色 = 3
		ELSEIF HAIR_COLOR > 160
			TALENT:CHARA:髪の色 = 6
		ELSEIF HAIR_COLOR > 150
			TALENT:CHARA:髪の色 = 7
		ELSEIF HAIR_COLOR > 140
			TALENT:CHARA:髪の色 = 2
		ELSEIF HAIR_COLOR > 130
			TALENT:CHARA:髪の色 = 4
		ELSEIF HAIR_COLOR > 120
			TALENT:CHARA:髪の色 = 1
		ELSE
			TALENT:CHARA:髪の色 = 5
		ENDIF
	ENDIF

	SIF RAND:5 != 0
		TALENT:CHARA:瞳の色 = TALENT:FAMILY_ID:瞳の色

	SIF RAND:3 == 0
		TALENT:CHARA:肉付き = TALENT:FAMILY_ID:肉付き

	SIF RAND:3 == 0
		TALENT:CHARA:乳首 = TALENT:FAMILY_ID:乳首

	IF RAND:3 == 0
		TALENT:CHARA:陰毛の状態 = TALENT:FAMILY_ID:陰毛の状態
		TALENT:CHARA:陰毛生育限界 = TALENT:FAMILY_ID:陰毛生育限界
	ENDIF
ENDIF
;--------------------
;各種経験
;--------------------

;出産経験
PREG_EXP = 0
LOCAL = TALENT:CHARA:320 % 10
IF LOCAL == 0 && TALENT:CHARA:157 == 1 && RAND:2 == 0
	PREG_EXP += RAND:3
ELSE
	;娘の数
	LOCAL:1 = TALENT:CHARA:320 % 1000
	PREG_EXP += LOCAL:1 / 100
	;息子の数
	LOCAL:1 = TALENT:CHARA:320 % 10000
	PREG_EXP += LOCAL:1 / 1000
ENDIF

SIF TALENT:CHARA:122
	PREG_EXP = 0

EXP:CHARA:60 += PREG_EXP

;性交経験
IF TALENT:CHARA:122 && TALENT:CHARA:1
	;童貞のオトコ
ELSEIF TALENT:CHARA:122 && TALENT:CHARA:1 == 0
	;非童貞のオトコ
	EXP:CHARA:5 = RAND:8 + 1 + PREG_EXP
ELSEIF TALENT:CHARA:0 == 0
	EXP:CHARA:0 = RAND:8 + 1 + PREG_EXP
	EXP:CHARA:5 = EXP:CHARA:0
ELSEIF PREG_EXP
	;処女であるのに出産経験がある
	EXP:CHARA:0 = RAND:4 + 1 + PREG_EXP
	EXP:CHARA:5 = EXP:CHARA:0
	;処女を消す
	TALENT:CHARA:0 = 0
ENDIF


;自慰経験
IF RAND:30 == 0
	;たまに猿みたいなオナニストが出現
	EXP:CHARA:10 = RAND:50
ELSEIF TALENT:CHARA:121 == 1 || TALENT:CHARA:122 == 1
	;ふたなり・オトコは自慰しちゃうよね
	EXP:CHARA:10 = RAND:30
ELSEIF TALENT:CHARA:60 == 1
	;自慰しやすい
	EXP:CHARA:10 = RAND:20
ELSEIF RAND:10 == 0
	;比較的自慰しちゃってる
	EXP:CHARA:10 = RAND:10
ENDIF

;ただしカルマが高いと自慰なんてしない
SIF CFLAG:CHARA:151 > 150
	EXP:CHARA:10 = 0

;オトコにV経験はない
SIF TALENT:CHARA:122
	EXP:CHARA:0 = 0
	

;初体験
CALL CHARA_FIRST_EXP, CHARA

;コスチューム
A = CHARA
CALL SET_CHAR_CLOTH

;一人称の設定
CALL RANDOM_SELF_CALL, CHARA

;年齢or身長などを表示する設定の場合は身体データを設定
IF GETBIT(FLAG:5,12) || GETBIT(FLAG:5,15)
;村娘Ａ・Ｂのみ年齢を指定してみる
	IF TALENT:CHARA:165
		CALL CHAR_SIZE_GENERATE, CHARA, RAND:2 + 12
	ELSEIF TALENT:CHARA:171
		CALL CHAR_SIZE_GENERATE, CHARA, RAND:2 + 17
	ELSE
		CALL CHAR_SIZE_GENERATE, CHARA
	ENDIF
	CFLAG:(CHARA):451 = RESULT:0
	CFLAG:(CHARA):452 = RESULT:1
	CFLAG:(CHARA):453 = RESULT:2
	CFLAG:(CHARA):454 = RESULT:3
	CFLAG:(CHARA):455 = RESULT:4
	CFLAG:(CHARA):456 = RESULT:5
	CFLAG:(CHARA):457 = RESULT:6
ENDIF


RETURN CHARA


;--------------------------------------
@RANDOM_NAME, ARG,CHARA
#DIM EUR_NUM
#DIM WA_NUM
#DIM NAME_TYPE
#DIM FAMILY_ID
#DIM N_LENGTH
#DIM CHARA
;--------------------------------------
;NAME_TYPE	名前の種類
;		0：指定なし　1：英名　2：和名　3：ランダム生成
;N_LENGTH	ランダム生成長さ
;CHARA	キャラID

;eraWIZを参考に.AはキャラNo
;洋名パターン数
EUR_NUM = 143
;和名パターン数
WA_NUM = 128

$NAME_NUM

NAME_TYPE = 0
SIF ARG
	NAME_TYPE = ARG

;家族の名前の種類を継承
LOCAL = CFLAG:CHARA:605
LOCAL:1 = LOCAL % 10
CALL SEARCH_FAMILY, CHARA
FAMILY_ID = RESULT

IF RAND:5 != 0 && FAMILY_ID > 0 && NAME_TYPE == 0
	;家族が洋名
	IF CFLAG:FAMILY_ID:6 < 200
		NAME_TYPE = 1
	;家族が生成名
	ELSEIF CFLAG:FAMILY_ID:6 > 1000000000
		NAME_TYPE = 3
	;家族が和名
	ELSE
		NAME_TYPE = 2
	ENDIF
ENDIF

;職業によって名前の種類に偏りを持たせる
IF TALENT:CHARA:騎士 && RAND:10 != 0 && NAME_TYPE == 0
	NAME_TYPE = 1
ELSEIF (TALENT:CHARA:巫女 || TALENT:CHARA:忍者) && RAND:4 != 0 && NAME_TYPE == 0
	NAME_TYPE = 2
ENDIF

;種族によって名前の種類に偏りを持たせる
IF RAND:3 == 0 && NAME_TYPE == 0
	;人間	指定なし
	IF CFLAG:CHARA:314 == 0
		NAME_TYPE = 0
	;エルフ	洋名
	ELSEIF CFLAG:CHARA:314 == 1
		NAME_TYPE = 1
	;人狼	和名
	ELSEIF CFLAG:CHARA:314 == 2
		NAME_TYPE = 2
	;吸血鬼	洋名
	ELSEIF CFLAG:CHARA:314 == 3
		NAME_TYPE = 1
	;デュラハン	洋名
	ELSEIF CFLAG:CHARA:314 == 4
		NAME_TYPE = 1
	;ドラゴン	生成名
	ELSEIF CFLAG:CHARA:314 == 5
		NAME_TYPE = 3
	;天使	洋名
	ELSEIF CFLAG:CHARA:314 == 6
		NAME_TYPE = 1
	;ダークエルフ	洋名
	ELSEIF CFLAG:CHARA:314 == 7
		NAME_TYPE = 1
	;堕天使	洋名
	ELSEIF CFLAG:CHARA:314 == 8
		NAME_TYPE = 1
	;魔族	指定なし
	ELSEIF CFLAG:CHARA:314 == 9
	;ホビット	生成名
	ELSEIF CFLAG:CHARA:314 == 10
		NAME_TYPE = 3
	;ドワーフ	生成名
	ELSEIF CFLAG:CHARA:314 == 11
		NAME_TYPE = 3
	;その他　必要ないと思うけど指定なし
	ELSE
		NAME_TYPE = 0
	ENDIF
ENDIF

IF NAME_TYPE == 1 || (NAME_TYPE == 0 && RAND:4 == 0)
	CFLAG:CHARA:6 = RAND:EUR_NUM
ELSEIF NAME_TYPE == 2 || (NAME_TYPE == 0 && RAND:2)
	CFLAG:CHARA:6 = RAND:WA_NUM + 200
ELSE
	N_LENGTH = 3 - RAND:2 - RAND:3 % 2
	CFLAG:CHARA:6 = 0
	REPEAT N_LENGTH
		CFLAG:CHARA:6 *= 1000
		;終端にのみ使える文字列かどうか
		IF COUNT == 0 && N_LENGTH > 1 && RAND:5 != 0
			M = 2
		ELSE
			M = 1
		ENDIF

		IF M == 1
			IF (RAND:3 == 0 && N_LENGTH != 1) || (RAND:2 == 0 && N_LENGTH == 3)
				N = RAND:9 + 300
			ELSE
				N = RAND:30 + 200
			ENDIF
		ELSE
			IF RAND:8 == 0 && N_LENGTH != 1
				N = RAND:2 + 500
			ELSE
				N = RAND:27 + 400
			ENDIF
		ENDIF
		CFLAG:CHARA:6 += N
		SIF COUNT < 0
			BREAK
		SIF N_LENGTH == 1 && (N == 200 || N == 201 || N == 204 || N == 205 || N == 207 || N == 208 || N == 210 || N == 215 || N == 217 || N == 218 || N == 219 || N == 227)
			COUNT -= 10
	REND
	CFLAG:CHARA:6 += 2000000000
ENDIF

IF CHARANUM < (EUR_NUM + WA_NUM) * 4 /10
	REPEAT CHARANUM
		SIF COUNT == CHARA
			CONTINUE
		SIF CFLAG:COUNT:6 == CFLAG:CHARA:6
			GOTO NAME_NUM
	REND
ENDIF

CALL NAMING, CHARA

;--------------------------------------
@NAMING,CHARA
#DIM CHARA
#DIM NAME_ID
#DIM NAME_RAND_ID,2
;--------------------------------------
;ユーザー設定名前
IF CFLAG:CHARA:420 != 0
	SAVESTR:CHARA = %CSTR:CHARA:1%
	RETURN 0
ENDIF

;ユニークの固有名を設定
IF TALENT:CHARA:村娘Ａ
	SAVESTR:CHARA = Mao
	RETURN 0
ELSEIF TALENT:CHARA:ハート
	SAVESTR:CHARA = Gold Heart
	RETURN 0
ELSEIF TALENT:CHARA:スペード
	SAVESTR:CHARA = Silver Spade
	RETURN 0
ELSEIF TALENT:CHARA:ダイヤ
	SAVESTR:CHARA = Black Diamond
	RETURN 0
ELSEIF TALENT:CHARA:クラブ
	SAVESTR:CHARA = White Club
	RETURN 0
ELSEIF TALENT:CHARA:村娘Ｂ
	SAVESTR:CHARA = Lily
	RETURN 0
ENDIF


;名前決定
NAME_ID = CFLAG:CHARA:6

IF NAME_ID < 1000000000
	IF NAME_ID == 0
		SAVESTR:CHARA = Mary
	ELSEIF NAME_ID == 1
		SAVESTR:CHARA = Sofia
	ELSEIF NAME_ID == 2
		SAVESTR:CHARA = Anna
	ELSEIF NAME_ID == 3
		SAVESTR:CHARA = Sylvia
	ELSEIF NAME_ID == 4
		SAVESTR:CHARA = Katya
	ELSEIF NAME_ID == 5
		SAVESTR:CHARA = Erie
	ELSEIF NAME_ID == 6
		SAVESTR:CHARA = Michelle
	ELSEIF NAME_ID == 7
		SAVESTR:CHARA = Ellen
	ELSEIF NAME_ID == 8
		SAVESTR:CHARA = Etica
	ELSEIF NAME_ID == 9
		SAVESTR:CHARA = Alice
	ELSEIF NAME_ID == 10
		SAVESTR:CHARA = Francoise
	ELSEIF NAME_ID == 11
		SAVESTR:CHARA = Elektra
	ELSEIF NAME_ID == 12
		SAVESTR:CHARA = Grace
	ELSEIF NAME_ID == 13
		SAVESTR:CHARA = Jessica
	ELSEIF NAME_ID == 14
		SAVESTR:CHARA = Leia
	ELSEIF NAME_ID == 15
		SAVESTR:CHARA = Rebeka
	ELSEIF NAME_ID == 16
		SAVESTR:CHARA = Velvet
	ELSEIF NAME_ID == 17
		SAVESTR:CHARA = Lily
	ELSEIF NAME_ID == 18
		SAVESTR:CHARA = Ekaterina
	ELSEIF NAME_ID == 19
		SAVESTR:CHARA = Agatha
	ELSEIF NAME_ID == 20
		SAVESTR:CHARA = Amelia
	ELSEIF NAME_ID == 21
		SAVESTR:CHARA = Angelica
	ELSEIF NAME_ID == 22
		SAVESTR:CHARA = Bridget
	ELSEIF NAME_ID == 23
		SAVESTR:CHARA = Christina
	ELSEIF NAME_ID == 24
		SAVESTR:CHARA = Claudia
	ELSEIF NAME_ID == 25
		SAVESTR:CHARA = Cheryl
	ELSEIF NAME_ID == 26
		SAVESTR:CHARA = Sherry
	ELSEIF NAME_ID == 27
		SAVESTR:CHARA = Cecilia
	ELSEIF NAME_ID == 28
		SAVESTR:CHARA = Bella
	ELSEIF NAME_ID == 29
		SAVESTR:CHARA = Becky
	ELSEIF NAME_ID == 30
		SAVESTR:CHARA = Avery
	ELSEIF NAME_ID == 31
		SAVESTR:CHARA = Dorothy
	ELSEIF NAME_ID == 32
		SAVESTR:CHARA = Emily
	ELSEIF NAME_ID == 33
		SAVESTR:CHARA = Felicia
	ELSEIF NAME_ID == 34
		SAVESTR:CHARA = Francisca
	ELSEIF NAME_ID == 35
		SAVESTR:CHARA = Gloria
	ELSEIF NAME_ID == 36
		SAVESTR:CHARA = Jennifer
	ELSEIF NAME_ID == 37
		SAVESTR:CHARA = Margaret
	ELSEIF NAME_ID == 38
		SAVESTR:CHARA = Olivia
	ELSEIF NAME_ID == 39
		SAVESTR:CHARA = Veronica
	ELSEIF NAME_ID == 40
		SAVESTR:CHARA = Serafina
	ELSEIF NAME_ID == 41
		SAVESTR:CHARA = Flore
	ELSEIF NAME_ID == 42
		SAVESTR:CHARA = Tabitha
	ELSEIF NAME_ID == 43
		SAVESTR:CHARA = Ada
	ELSEIF NAME_ID == 44
		SAVESTR:CHARA = Carol
	ELSEIF NAME_ID == 45
		SAVESTR:CHARA = Charlotto
	ELSEIF NAME_ID == 46
		SAVESTR:CHARA = Cordelia
	ELSEIF NAME_ID == 47
		SAVESTR:CHARA = Emilia
	ELSEIF NAME_ID == 48
		SAVESTR:CHARA = Erica
	ELSEIF NAME_ID == 49
		SAVESTR:CHARA = Eve
	ELSEIF NAME_ID == 50
		SAVESTR:CHARA = Henrietta
	ELSEIF NAME_ID == 51
		SAVESTR:CHARA = Iris
	ELSEIF NAME_ID == 52
		SAVESTR:CHARA = Ivy
	ELSEIF NAME_ID == 53
		SAVESTR:CHARA = Louise
	ELSEIF NAME_ID == 54
		SAVESTR:CHARA = Lidia
	ELSEIF NAME_ID == 55
		SAVESTR:CHARA = Mabel
	ELSEIF NAME_ID == 56
		SAVESTR:CHARA = Natalia
	ELSEIF NAME_ID == 57
		SAVESTR:CHARA = Nina
	ELSEIF NAME_ID == 58
		SAVESTR:CHARA = Nora
	ELSEIF NAME_ID == 59
		SAVESTR:CHARA = Patricia
	ELSEIF NAME_ID == 60
		SAVESTR:CHARA = Phyllis
	ELSEIF NAME_ID == 61
		SAVESTR:CHARA = Rachel
	ELSEIF NAME_ID == 62
		SAVESTR:CHARA = Rosemary
	ELSEIF NAME_ID == 63
		SAVESTR:CHARA = Scarlett
	ELSEIF NAME_ID == 64
		SAVESTR:CHARA = Shirley
	ELSEIF NAME_ID == 65
		SAVESTR:CHARA = Stella
	ELSEIF NAME_ID == 66
		SAVESTR:CHARA = Suzy
	ELSEIF NAME_ID == 67
		SAVESTR:CHARA = Vanessa
	ELSEIF NAME_ID == 68
		SAVESTR:CHARA = Wendy
	ELSEIF NAME_ID == 69
		SAVESTR:CHARA = Annelise
	ELSEIF NAME_ID == 70
		SAVESTR:CHARA = Bianca
	ELSEIF NAME_ID == 71
		SAVESTR:CHARA = Cornelia
	ELSEIF NAME_ID == 72
		SAVESTR:CHARA = Julia
	ELSEIF NAME_ID == 73
		SAVESTR:CHARA = Eleonora
	ELSEIF NAME_ID == 74
		SAVESTR:CHARA = Elfriede
	ELSEIF NAME_ID == 75
		SAVESTR:CHARA = Liselotte
	ELSEIF NAME_ID == 76
		SAVESTR:CHARA = Vilhelmia
	ELSEIF NAME_ID == 77
		SAVESTR:CHARA = Anastasia
	ELSEIF NAME_ID == 78
		SAVESTR:CHARA = Chloe
	ELSEIF NAME_ID == 79
		SAVESTR:CHARA = Olga
	ELSEIF NAME_ID == 80
		SAVESTR:CHARA = Kuderia
	ELSEIF NAME_ID == 81
		SAVESTR:CHARA = Charlotte
	ELSEIF NAME_ID == 82
		SAVESTR:CHARA = Elsa

;20151225追加分
	ELSEIF NAME_ID == 83
		SAVESTR:CHARA = Iris
	ELSEIF NAME_ID == 84
		SAVESTR:CHARA = Irene
	ELSEIF NAME_ID == 85
		SAVESTR:CHARA = Alicia
	ELSEIF NAME_ID == 86
		SAVESTR:CHARA = Angeline
	ELSEIF NAME_ID == 87
		SAVESTR:CHARA = Ingrid
	ELSEIF NAME_ID == 88
		SAVESTR:CHARA = Vivian
	ELSEIF NAME_ID == 89
		SAVESTR:CHARA = Evangeline
	ELSEIF NAME_ID == 90
		SAVESTR:CHARA = Emilia
	ELSEIF NAME_ID == 91
		SAVESTR:CHARA = Elise
	ELSEIF NAME_ID == 92
		SAVESTR:CHARA = Eleonol
	ELSEIF NAME_ID == 93
		SAVESTR:CHARA = Edelgard
	ELSEIF NAME_ID == 94
		SAVESTR:CHARA = Ophelia
	ELSEIF NAME_ID == 95
		SAVESTR:CHARA = Canon
	ELSEIF NAME_ID == 96
		SAVESTR:CHARA = Sara
	ELSEIF NAME_ID == 97
		SAVESTR:CHARA = Cyan
	ELSEIF NAME_ID == 98
		SAVESTR:CHARA = Jiji
	ELSEIF NAME_ID == 99
		SAVESTR:CHARA = Gisele
	ELSEIF NAME_ID == 100
		SAVESTR:CHARA = Shannon
	ELSEIF NAME_ID == 101
		SAVESTR:CHARA = Shamara
	ELSEIF NAME_ID == 102
		SAVESTR:CHARA = Sharon
	ELSEIF NAME_ID == 103
		SAVESTR:CHARA = Genevieve
	ELSEIF NAME_ID == 104
		SAVESTR:CHARA = Sylvie
	ELSEIF NAME_ID == 105
		SAVESTR:CHARA = Sylvia
	ELSEIF NAME_ID == 106
		SAVESTR:CHARA = Cecil
	ELSEIF NAME_ID == 107
		SAVESTR:CHARA = Selma
	ELSEIF NAME_ID == 108
		SAVESTR:CHARA = Czirya
	ELSEIF NAME_ID == 109
		SAVESTR:CHARA = Tia
	ELSEIF NAME_ID == 110
		SAVESTR:CHARA = Dietlinde
	ELSEIF NAME_ID == 111
		SAVESTR:CHARA = Noel
	ELSEIF NAME_ID == 112
		SAVESTR:CHARA = Fatima
	ELSEIF NAME_ID == 113
		SAVESTR:CHARA = Blanche
	ELSEIF NAME_ID == 114
		SAVESTR:CHARA = Priscilla
	ELSEIF NAME_ID == 115
		SAVESTR:CHARA = Primrose
	ELSEIF NAME_ID == 116
		SAVESTR:CHARA = Fleur
	ELSEIF NAME_ID == 117
		SAVESTR:CHARA = Florence
	ELSEIF NAME_ID == 118
		SAVESTR:CHARA = Beryl
	ELSEIF NAME_ID == 119
		SAVESTR:CHARA = Hazel
	ELSEIF NAME_ID == 120
		SAVESTR:CHARA = Marcia
	ELSEIF NAME_ID == 121
		SAVESTR:CHARA = Muriel
	ELSEIF NAME_ID == 122
		SAVESTR:CHARA = Misha
	ELSEIF NAME_ID == 123
		SAVESTR:CHARA = Milya
	ELSEIF NAME_ID == 124
		SAVESTR:CHARA = Mei
	ELSEIF NAME_ID == 125
		SAVESTR:CHARA = Melvina
	ELSEIF NAME_ID == 126
		SAVESTR:CHARA = Melody
	ELSEIF NAME_ID == 127
		SAVESTR:CHARA = Yunsu
	ELSEIF NAME_ID == 128
		SAVESTR:CHARA = Euphemia
	ELSEIF NAME_ID == 129
		SAVESTR:CHARA = Latisha
	ELSEIF NAME_ID == 130
		SAVESTR:CHARA = Laura
	ELSEIF NAME_ID == 131
		SAVESTR:CHARA = Ria
	ELSEIF NAME_ID == 132
		SAVESTR:CHARA = Lucrece
	ELSEIF NAME_ID == 133
		SAVESTR:CHARA = Lucienne
	ELSEIF NAME_ID == 134
		SAVESTR:CHARA = Lucrezia
	ELSEIF NAME_ID == 135
		SAVESTR:CHARA = Lucille
	ELSEIF NAME_ID == 136
		SAVESTR:CHARA = Luna
	ELSEIF NAME_ID == 137
		SAVESTR:CHARA = Lulu
	ELSEIF NAME_ID == 138
		SAVESTR:CHARA = Leila
	ELSEIF NAME_ID == 139
		SAVESTR:CHARA = Leticia
	ELSEIF NAME_ID == 140
		SAVESTR:CHARA = Rosalinda
	ELSEIF NAME_ID == 141
		SAVESTR:CHARA = Rosalia
	ELSEIF NAME_ID == 142
		SAVESTR:CHARA = Loretta

;和名
	ELSEIF NAME_ID == 200
		SAVESTR:CHARA = Sakura
	ELSEIF NAME_ID == 201
		SAVESTR:CHARA = Haruka
	ELSEIF NAME_ID == 202
		SAVESTR:CHARA = Kasumi
	ELSEIF NAME_ID == 203
		SAVESTR:CHARA = Hina
	ELSEIF NAME_ID == 204
		SAVESTR:CHARA = Aoi
	ELSEIF NAME_ID == 205
		SAVESTR:CHARA = Mizuho
	ELSEIF NAME_ID == 206
		SAVESTR:CHARA = Aya
	ELSEIF NAME_ID == 207
		SAVESTR:CHARA = Tomoe
	ELSEIF NAME_ID == 208
		SAVESTR:CHARA = Satsuki
	ELSEIF NAME_ID == 209
		SAVESTR:CHARA = Yayoi
	ELSEIF NAME_ID == 210
		SAVESTR:CHARA = Nadeshiko
	ELSEIF NAME_ID == 211
		SAVESTR:CHARA = Kanami
	ELSEIF NAME_ID == 212
		SAVESTR:CHARA = Ayame
	ELSEIF NAME_ID == 213
		SAVESTR:CHARA = Yui
	ELSEIF NAME_ID == 214
		SAVESTR:CHARA = Rin
	ELSEIF NAME_ID == 215
		SAVESTR:CHARA = Hinata
	ELSEIF NAME_ID == 216
		SAVESTR:CHARA = Asagi
	ELSEIF NAME_ID == 217
		SAVESTR:CHARA = Yukikaze
	ELSEIF NAME_ID == 218
		SAVESTR:CHARA = Ran
	ELSEIF NAME_ID == 219
		SAVESTR:CHARA = Hime
	ELSEIF NAME_ID == 220
		SAVESTR:CHARA = Asuka
	ELSEIF NAME_ID == 221
		SAVESTR:CHARA = Sagiri
	ELSEIF NAME_ID == 222
		SAVESTR:CHARA = Mizuki
	ELSEIF NAME_ID == 223
		SAVESTR:CHARA = Homura
	ELSEIF NAME_ID == 224
		SAVESTR:CHARA = Sayaka
	ELSEIF NAME_ID == 225
		SAVESTR:CHARA = Manaka
	ELSEIF NAME_ID == 226
		SAVESTR:CHARA = Eri
	ELSEIF NAME_ID == 227
		SAVESTR:CHARA = Ringo
	ELSEIF NAME_ID == 228
		SAVESTR:CHARA = Kanami
;20151225追加分
	ELSEIF NAME_ID == 229
		SAVESTR:CHARA = Amane
	ELSEIF NAME_ID == 230
		SAVESTR:CHARA = Ayano
	ELSEIF NAME_ID == 231
		SAVESTR:CHARA = Iori
	ELSEIF NAME_ID == 232
		SAVESTR:CHARA = Izanami
	ELSEIF NAME_ID == 233
		SAVESTR:CHARA = Izayoi
	ELSEIF NAME_ID == 234
		SAVESTR:CHARA = Iroha
	ELSEIF NAME_ID == 235
		SAVESTR:CHARA = Urara
	ELSEIF NAME_ID == 236
		SAVESTR:CHARA = Ouka
	ELSEIF NAME_ID == 237
		SAVESTR:CHARA = Otoha
	ELSEIF NAME_ID == 238
		SAVESTR:CHARA = Otome
	ELSEIF NAME_ID == 239
		SAVESTR:CHARA = Oboro
	ELSEIF NAME_ID == 240
		SAVESTR:CHARA = Kaede
	ELSEIF NAME_ID == 241
		SAVESTR:CHARA = Kagari
	ELSEIF NAME_ID == 242
		SAVESTR:CHARA = Kagaribi
	ELSEIF NAME_ID == 243
		SAVESTR:CHARA = Kagura
	ELSEIF NAME_ID == 244
		SAVESTR:CHARA = Kasuga
	ELSEIF NAME_ID == 245
		SAVESTR:CHARA = Kanae
	ELSEIF NAME_ID == 246
		SAVESTR:CHARA = Kaya
	ELSEIF NAME_ID == 247
		SAVESTR:CHARA = Kanazuki
	ELSEIF NAME_ID == 248
		SAVESTR:CHARA = Kikyou
	ELSEIF NAME_ID == 249
		SAVESTR:CHARA = Kisaragi
	ELSEIF NAME_ID == 250
		SAVESTR:CHARA = Kikka
	ELSEIF NAME_ID == 251
		SAVESTR:CHARA = Kuon
	ELSEIF NAME_ID == 252
		SAVESTR:CHARA = Kurenai
	ELSEIF NAME_ID == 253
		SAVESTR:CHARA = Kureha
	ELSEIF NAME_ID == 254
		SAVESTR:CHARA = Kokono
	ELSEIF NAME_ID == 255
		SAVESTR:CHARA = Kochou
	ELSEIF NAME_ID == 256
		SAVESTR:CHARA = Kotone
	ELSEIF NAME_ID == 257
		SAVESTR:CHARA = Kotonoha
	ELSEIF NAME_ID == 258
		SAVESTR:CHARA = Komachi
	ELSEIF NAME_ID == 259
		SAVESTR:CHARA = Sakuya
	ELSEIF NAME_ID == 260
		SAVESTR:CHARA = Sazanami
	ELSEIF NAME_ID == 261
		SAVESTR:CHARA = Sazanka
	ELSEIF NAME_ID == 262
		SAVESTR:CHARA = Satsuki
	ELSEIF NAME_ID == 263
		SAVESTR:CHARA = Samidare
	ELSEIF NAME_ID == 264
		SAVESTR:CHARA = Saya
	ELSEIF NAME_ID == 265
		SAVESTR:CHARA = Shizu
	ELSEIF NAME_ID == 266
		SAVESTR:CHARA = Shizuku
	ELSEIF NAME_ID == 267
		SAVESTR:CHARA = Shino
	ELSEIF NAME_ID == 268
		SAVESTR:CHARA = Shiranui
	ELSEIF NAME_ID == 269
		SAVESTR:CHARA = Shirogane
	ELSEIF NAME_ID == 270
		SAVESTR:CHARA = Suzu
	ELSEIF NAME_ID == 271
		SAVESTR:CHARA = Suzuran
	ELSEIF NAME_ID == 272
		SAVESTR:CHARA = Setsuna
	ELSEIF NAME_ID == 273
		SAVESTR:CHARA = Tsukuyomi
	ELSEIF NAME_ID == 274
		SAVESTR:CHARA = Tsuzuri
	ELSEIF NAME_ID == 275
		SAVESTR:CHARA = Tsubaki
	ELSEIF NAME_ID == 276
		SAVESTR:CHARA = Tsurara
	ELSEIF NAME_ID == 277
		SAVESTR:CHARA = Tokiwa
	ELSEIF NAME_ID == 278
		SAVESTR:CHARA = Towa
	ELSEIF NAME_ID == 279
		SAVESTR:CHARA = Nagatsuki
	ELSEIF NAME_ID == 280
		SAVESTR:CHARA = Nagisa
	ELSEIF NAME_ID == 281
		SAVESTR:CHARA = Nana
	ELSEIF NAME_ID == 282
		SAVESTR:CHARA = Nanase
	ELSEIF NAME_ID == 283
		SAVESTR:CHARA = Nayuta
	ELSEIF NAME_ID == 284
		SAVESTR:CHARA = Hazuki
	ELSEIF NAME_ID == 285
		SAVESTR:CHARA = Hanakagari
	ELSEIF NAME_ID == 286
		SAVESTR:CHARA = Hayate
	ELSEIF NAME_ID == 287
		SAVESTR:CHARA = Hisui
	ELSEIF NAME_ID == 288
		SAVESTR:CHARA = Hinagiku
	ELSEIF NAME_ID == 289
		SAVESTR:CHARA = Hifumi
	ELSEIF NAME_ID == 290
		SAVESTR:CHARA = Himawari
	ELSEIF NAME_ID == 291
		SAVESTR:CHARA = Byakuya
	ELSEIF NAME_ID == 292
		SAVESTR:CHARA = Hiyori
	ELSEIF NAME_ID == 293
		SAVESTR:CHARA = Fuzuki
	ELSEIF NAME_ID == 294
		SAVESTR:CHARA = Makoto
	ELSEIF NAME_ID == 295
		SAVESTR:CHARA = Mashiro
	ELSEIF NAME_ID == 296
		SAVESTR:CHARA = Matsukaze
	ELSEIF NAME_ID == 297
		SAVESTR:CHARA = Matsuri
	ELSEIF NAME_ID == 298
		SAVESTR:CHARA = Manazuru
	ELSEIF NAME_ID == 299
		SAVESTR:CHARA = Mayu
	ELSEIF NAME_ID == 300
		SAVESTR:CHARA = Miu
	ELSEIF NAME_ID == 301
		SAVESTR:CHARA = Mikazuki
	ELSEIF NAME_ID == 302
		SAVESTR:CHARA = Misao
	ELSEIF NAME_ID == 303
		SAVESTR:CHARA = Misora
	ELSEIF NAME_ID == 304
		SAVESTR:CHARA = Minazuki
	ELSEIF NAME_ID == 305
		SAVESTR:CHARA = Miyako
	ELSEIF NAME_ID == 306
		SAVESTR:CHARA = Miyabi
	ELSEIF NAME_ID == 307
		SAVESTR:CHARA = Mutsuki
	ELSEIF NAME_ID == 308
		SAVESTR:CHARA = Murasaki
	ELSEIF NAME_ID == 309
		SAVESTR:CHARA = Murasame
	ELSEIF NAME_ID == 310
		SAVESTR:CHARA = Momiji
	ELSEIF NAME_ID == 311
		SAVESTR:CHARA = Yae
	ELSEIF NAME_ID == 312
		SAVESTR:CHARA = Yayoi
	ELSEIF NAME_ID == 313
		SAVESTR:CHARA = Yugao
	ELSEIF NAME_ID == 314
		SAVESTR:CHARA = Yuzuru
	ELSEIF NAME_ID == 315
		SAVESTR:CHARA = Yuna
	ELSEIF NAME_ID == 316
		SAVESTR:CHARA = Yukari
	ELSEIF NAME_ID == 317
		SAVESTR:CHARA = Yukiji
	ELSEIF NAME_ID == 318
		SAVESTR:CHARA = Yuzu
	ELSEIF NAME_ID == 319
		SAVESTR:CHARA = Yuzuriha
	ELSEIF NAME_ID == 320
		SAVESTR:CHARA = Yuno
	ELSEIF NAME_ID == 321
		SAVESTR:CHARA = Yumeji
	ELSEIF NAME_ID == 322
		SAVESTR:CHARA = Yomi
	ELSEIF NAME_ID == 323
		SAVESTR:CHARA = Rikka
	ELSEIF NAME_ID == 324
		SAVESTR:CHARA = Ruri
	ELSEIF NAME_ID == 325
		SAVESTR:CHARA = Renge
	ELSEIF NAME_ID == 326
		SAVESTR:CHARA = Wakana
	ELSEIF NAME_ID == 327
		SAVESTR:CHARA = Wakaba
	ENDIF
ELSE
	SAVESTR:CHARA = 
	NAME_RAND_ID = NAME_ID % 1000000000
;ランダム名ver0.2
	IF NAME_ID > 2000000000
		WHILE NAME_RAND_ID > 1
			NAME_RAND_ID:1 = NAME_RAND_ID % 1000
;汎用
			IF NAME_RAND_ID:1 == 200
				LOCALS = a
			ELSEIF NAME_RAND_ID:1 == 201
				LOCALS = amu
			ELSEIF NAME_RAND_ID:1 == 202
				LOCALS = aru
			ELSEIF NAME_RAND_ID:1 == 203
				LOCALS = an
			ELSEIF NAME_RAND_ID:1 == 204
				LOCALS = ia
			ELSEIF NAME_RAND_ID:1 == 205
				LOCALS = uru
			ELSEIF NAME_RAND_ID:1 == 206
				LOCALS = ea
			ELSEIF NAME_RAND_ID:1 == 207
				LOCALS = karu
			ELSEIF NAME_RAND_ID:1 == 208
				LOCALS = shii
			ELSEIF NAME_RAND_ID:1 == 209
				LOCALS = shia
			ELSEIF NAME_RAND_ID:1 == 210
				LOCALS = suto
			ELSEIF NAME_RAND_ID:1 == 211
				LOCALS = naru
			ELSEIF NAME_RAND_ID:1 == 212
				LOCALS = nea
			ELSEIF NAME_RAND_ID:1 == 213
				LOCALS = firu
			ELSEIF NAME_RAND_ID:1 == 214
				LOCALS = foru
			ELSEIF NAME_RAND_ID:1 == 215
				LOCALS = misu
			ELSEIF NAME_RAND_ID:1 == 216
				LOCALS = mei
			ELSEIF NAME_RAND_ID:1 == 217
				LOCALS = meti
			ELSEIF NAME_RAND_ID:1 == 218
				LOCALS = rao
			ELSEIF NAME_RAND_ID:1 == 219
				LOCALS = rana
			ELSEIF NAME_RAND_ID:1 == 220
				LOCALS = rii
			ELSEIF NAME_RAND_ID:1 == 221
				LOCALS = ryi
			ELSEIF NAME_RAND_ID:1 == 222
				LOCALS = rizu
			ELSEIF NAME_RAND_ID:1 == 223
				LOCALS = ryuu
			ELSEIF NAME_RAND_ID:1 == 224
				LOCALS = ruu
			ELSEIF NAME_RAND_ID:1 == 225
				LOCALS = ruku
			ELSEIF NAME_RAND_ID:1 == 226
				LOCALS = rei
			ELSEIF NAME_RAND_ID:1 == 227
				LOCALS = rese
			ELSEIF NAME_RAND_ID:1 == 228
				LOCALS = rera
			ELSEIF NAME_RAND_ID:1 == 229
				LOCALS = ren
;汎用一音
			ELSEIF NAME_RAND_ID:1 == 300
				LOCALS = vi
			ELSEIF NAME_RAND_ID:1 == 301
				LOCALS = shi
			ELSEIF NAME_RAND_ID:1 == 302
				LOCALS = she
			ELSEIF NAME_RAND_ID:1 == 303
				LOCALS = sha
			ELSEIF NAME_RAND_ID:1 == 304
				LOCALS = ti
			ELSEIF NAME_RAND_ID:1 == 305
				LOCALS = tu
			ELSEIF NAME_RAND_ID:1 == 306
				LOCALS = ri
			ELSEIF NAME_RAND_ID:1 == 307
				LOCALS = ru
			ELSEIF NAME_RAND_ID:1 == 308
				LOCALS = re
;終端
			ELSEIF NAME_RAND_ID:1 == 400
				LOCALS = via
			ELSEIF NAME_RAND_ID:1 == 400
				LOCALS = on
			ELSEIF NAME_RAND_ID:1 == 402
				LOCALS = kia
			ELSEIF NAME_RAND_ID:1 == 403
				LOCALS = sha
			ELSEIF NAME_RAND_ID:1 == 404
				LOCALS = ta
			ELSEIF NAME_RAND_ID:1 == 405
				LOCALS = taria
			ELSEIF NAME_RAND_ID:1 == 406
				LOCALS = tia
			ELSEIF NAME_RAND_ID:1 == 407
				LOCALS = dia
			ELSEIF NAME_RAND_ID:1 == 408
				LOCALS = tisu
			ELSEIF NAME_RAND_ID:1 == 409
				LOCALS = nia
			ELSEIF NAME_RAND_ID:1 == 410
				LOCALS = fa
			ELSEIF NAME_RAND_ID:1 == 411
				LOCALS = fia
			ELSEIF NAME_RAND_ID:1 == 412
				LOCALS = fura
			ELSEIF NAME_RAND_ID:1 == 413
				LOCALS = mia
			ELSEIF NAME_RAND_ID:1 == 414
				LOCALS = ria
			ELSEIF NAME_RAND_ID:1 == 415
				LOCALS = rika
			ELSEIF NAME_RAND_ID:1 == 416
				LOCALS = risu
			ELSEIF NAME_RAND_ID:1 == 417
				LOCALS = rize
			ELSEIF NAME_RAND_ID:1 == 418
				LOCALS = rima
			ELSEIF NAME_RAND_ID:1 == 419
				LOCALS = riru
			ELSEIF NAME_RAND_ID:1 == 420
				LOCALS = zu
			ELSEIF NAME_RAND_ID:1 == 421
				LOCALS = ze
			ELSEIF NAME_RAND_ID:1 == 422
				LOCALS = na
			ELSEIF NAME_RAND_ID:1 == 423
				LOCALS = fa
			ELSEIF NAME_RAND_ID:1 == 424
				LOCALS = ma
			ELSEIF NAME_RAND_ID:1 == 425
				LOCALS = ra
			ELSEIF NAME_RAND_ID:1 == 426
				LOCALS = rra
;終端一音
			ELSEIF NAME_RAND_ID:1 == 500
				LOCALS = -
			ELSEIF NAME_RAND_ID:1 == 501
				LOCALS = n
;使用しない
			ELSEIF NAME_RAND_ID:1 == 900
				LOCALS = san
			ELSEIF NAME_RAND_ID:1 == 901
				LOCALS = shifu
			ELSEIF NAME_RAND_ID:1 == 902
				LOCALS = sora
			ELSEIF NAME_RAND_ID:1 == 903
				LOCALS = miro

			ENDIF
			STRLENS LOCALS
			SUBSTRING LOCALS, 0, 1
			IF LOCALS:1 == RESULTS && (LOCALS:1 == "ア" || LOCALS:1 == "イ" || LOCALS:1 == "ウ" || LOCALS:1 == "エ" || LOCALS:1 == "オ" || LOCALS:1 == "ン" || LOCALS:1 == "ー")
				SUBSTRING LOCALS, 2, RESULT - 1
				LOCALS = %RESULTS%
			ENDIF
			IF RESULTS == "ッ" && LOCALS:1 == "ー"
				STRLENS SAVESTR:CHARA
				SUBSTRING SAVESTR:CHARA, 0, RESULT - 2
				SAVESTR:CHARA = %RESULTS%
			ENDIF
			SUBSTRING LOCALS, RESULT - 2, RESULT - 1
			LOCALS:1 = %RESULTS%
			SAVESTR:CHARA = %SAVESTR:CHARA%%LOCALS%
			NAME_RAND_ID /= 1000
		WEND
;ランダム名ver0.1
	ELSEIF NAME_ID > 1000000000
		WHILE NAME_RAND_ID > 1
			NAME_RAND_ID:1 = NAME_RAND_ID % 1000
			IF NAME_RAND_ID:1 == 100
				SAVESTR:CHARA = %SAVESTR:CHARA%a
			ELSEIF NAME_RAND_ID:1 == 101
				SAVESTR:CHARA = %SAVESTR:CHARA%amu
			ELSEIF NAME_RAND_ID:1 == 102
				SAVESTR:CHARA = %SAVESTR:CHARA%aru
			ELSEIF NAME_RAND_ID:1 == 103
				SAVESTR:CHARA = %SAVESTR:CHARA%an
			ELSEIF NAME_RAND_ID:1 == 104
				SAVESTR:CHARA = %SAVESTR:CHARA%ia
			ELSEIF NAME_RAND_ID:1 == 105
				SAVESTR:CHARA = %SAVESTR:CHARA%ヴェ
			ELSEIF NAME_RAND_ID:1 == 106
				SAVESTR:CHARA = %SAVESTR:CHARA%uru
			ELSEIF NAME_RAND_ID:1 == 107
				SAVESTR:CHARA = %SAVESTR:CHARA%karu
			ELSEIF NAME_RAND_ID:1 == 108
				SAVESTR:CHARA = %SAVESTR:CHARA%san
			ELSEIF NAME_RAND_ID:1 == 109
				SAVESTR:CHARA = %SAVESTR:CHARA%shi
			ELSEIF NAME_RAND_ID:1 == 110
				SAVESTR:CHARA = %SAVESTR:CHARA%シー
			ELSEIF NAME_RAND_ID:1 == 111
				SAVESTR:CHARA = %SAVESTR:CHARA%シェ
			ELSEIF NAME_RAND_ID:1 == 112
				SAVESTR:CHARA = %SAVESTR:CHARA%shifu
			ELSEIF NAME_RAND_ID:1 == 113
				SAVESTR:CHARA = %SAVESTR:CHARA%シャ
			ELSEIF NAME_RAND_ID:1 == 114
				SAVESTR:CHARA = %SAVESTR:CHARA%ソラ
			ELSEIF NAME_RAND_ID:1 == 115
				SAVESTR:CHARA = %SAVESTR:CHARA%ティ
			ELSEIF NAME_RAND_ID:1 == 116
				SAVESTR:CHARA = %SAVESTR:CHARA%トゥ
			ELSEIF NAME_RAND_ID:1 == 117
				SAVESTR:CHARA = %SAVESTR:CHARA%ネア
			ELSEIF NAME_RAND_ID:1 == 118
				SAVESTR:CHARA = %SAVESTR:CHARA%フィル
			ELSEIF NAME_RAND_ID:1 == 119
				SAVESTR:CHARA = %SAVESTR:CHARA%フォル
			ELSEIF NAME_RAND_ID:1 == 120
				SAVESTR:CHARA = %SAVESTR:CHARA%ミロ
			ELSEIF NAME_RAND_ID:1 == 121
				SAVESTR:CHARA = %SAVESTR:CHARA%リ
			ELSEIF NAME_RAND_ID:1 == 122
				SAVESTR:CHARA = %SAVESTR:CHARA%リー
			ELSEIF NAME_RAND_ID:1 == 123
				SAVESTR:CHARA = %SAVESTR:CHARA%リィ
			ELSEIF NAME_RAND_ID:1 == 124
				SAVESTR:CHARA = %SAVESTR:CHARA%リズ
			ELSEIF NAME_RAND_ID:1 == 125
				SAVESTR:CHARA = %SAVESTR:CHARA%リュー
			ELSEIF NAME_RAND_ID:1 == 126
				SAVESTR:CHARA = %SAVESTR:CHARA%レイ
			ELSEIF NAME_RAND_ID:1 == 127
				SAVESTR:CHARA = %SAVESTR:CHARA%レラ
			ELSEIF NAME_RAND_ID:1 == 128
				SAVESTR:CHARA = %SAVESTR:CHARA%レン
			ELSEIF NAME_RAND_ID:1 == 200
				SAVESTR:CHARA = %SAVESTR:CHARA%ー
			ELSEIF NAME_RAND_ID:1 == 201
				SAVESTR:CHARA = %SAVESTR:CHARA%ヴィア
			ELSEIF NAME_RAND_ID:1 == 202
				SAVESTR:CHARA = %SAVESTR:CHARA%シア
			ELSEIF NAME_RAND_ID:1 == 203
				SAVESTR:CHARA = %SAVESTR:CHARA%タリア
			ELSEIF NAME_RAND_ID:1 == 204
				SAVESTR:CHARA = %SAVESTR:CHARA%ティア
			ELSEIF NAME_RAND_ID:1 == 205
				SAVESTR:CHARA = %SAVESTR:CHARA%ディア
			ELSEIF NAME_RAND_ID:1 == 206
				SAVESTR:CHARA = %SAVESTR:CHARA%ニア
			ELSEIF NAME_RAND_ID:1 == 207
				SAVESTR:CHARA = %SAVESTR:CHARA%フィア
			ELSEIF NAME_RAND_ID:1 == 208
				SAVESTR:CHARA = %SAVESTR:CHARA%ミア
			ELSEIF NAME_RAND_ID:1 == 209
				SAVESTR:CHARA = %SAVESTR:CHARA%リア
			ELSEIF NAME_RAND_ID:1 == 210
				SAVESTR:CHARA = %SAVESTR:CHARA%リカ
			ENDIF
			NAME_RAND_ID /= 1000
		WEND
	ENDIF
	LOCALS:1 = 
ENDIF

RETURN 0

@NAME_RESET
LOCAL = 0
REPEAT CHARANUM
	SIF LOCAL >= CHARANUM
		BREAK
	IF LOCAL >= 1
		LOCAL = COUNT
		CALL NAMING,LOCAL
	ENDIF
	LOCAL += 1 
REND

;---------------------------------------------------------
@SET_CHAR_CLOTH
;---------------------------------------------------------
;キャラのコスチュームを職業ごとに決定

IF TALENT:A:200 && TALENT:A:122
	;オトコ戦士
	;チェインメイル
	R = 3
	;初期装備：ソード
	CFLAG:A:550 = 40
ELSEIF TALENT:A:200
	;戦士
	
	;生成名でランダムで中華風
	IF CFLAG:A:6 > 1000000000 && RAND:3 == 0
		;チャイナドレス
		R = 214
		IF RAND:2 == 0
			;初期装備：クレセントブレード
			CFLAG:A:550 = 51
		ELSE
			;初期装備：ナックル
			CFLAG:A:550 = 52
		ENDIF
	ELSE
		
		IF RAND:6 == 0
			;レオタードアーマー
			R = 292
		ELSEIF RAND:5 == 0
			;ブレスト＆スカートアーマー
			R = 2
		ELSEIF RAND:4 == 0
			;チェインメイル
			R = 3
		ELSEIF RAND:3 == 0
			;レザー＆スカートアーマー
			R = 4
		ELSEIF RAND:2 == 0
			;ブレスト＆スパッツアーマー
			R = 108
		ELSE
			;ビキニアーマー
			R = 193
		ENDIF
		;初期装備：ソード
		CFLAG:A:550 = 40
	ENDIF
ELSEIF TALENT:A:201 && TALENT:A:122
	;オトコ魔術師
	;冒険服
	R = 103
	;アミュレット付き
	CFLAG:A:42 = 85
	;初期装備：スタッフ
	CFLAG:A:550 = 41
ELSEIF TALENT:A:201
	;魔術師
	IF RAND:3 == 0
		;スキン＆スカートアーマー
		R = 5
	ELSEIF RAND:2 == 0
		;タイツアーマー
		R = 251
	ELSE
		;冒険服
		R = 103
	ENDIF
	;アミュレット付き
	CFLAG:A:42 = 85
	;初期装備：スタッフ
	CFLAG:A:550 = 41
ELSEIF TALENT:A:202 && TALENT:A:122
	;オトコ神官
	;神官服
	R = 207
	;初期装備：メイス
	CFLAG:A:550 = 46
ELSEIF TALENT:A:202
	;神官
	IF RAND:3 == 0
		;スキン＆スカートアーマー
		R = 5
	ELSEIF RAND:2 == 0
		;タイツアーマー
		R = 251
	ELSE
		;神官服
		R = 207
	ENDIF
	;初期装備：メイス
	CFLAG:A:550 = 46
ELSEIF TALENT:A:203 && TALENT:A:122
	;オトコ盗賊
	;冒険服
	R = 103
	;初期装備：ダガー
	CFLAG:A:550 = 43
ELSEIF TALENT:A:203
	;盗賊
	IF RAND:3 == 0
		;スキン＆スカートアーマー
		R = 5
	ELSEIF RAND:2 == 0
		;タイツアーマー
		R = 251
	ELSE
		;冒険服
		R = 103
	ENDIF
	;初期装備：ダガー
	CFLAG:A:550 = 43
ELSEIF TALENT:A:205 && TALENT:A:122
	;オトコ騎士
	;騎士鎧
	R = 105
	;初期装備：ソード
	CFLAG:A:550 = 40
ELSEIF TALENT:A:205
	;騎士
	IF RAND:3 == 0
		;騎士鎧
		R = 105
	ELSEIF RAND:2 == 0
		;キュイラス＆スカート
		R = 6
	ELSE
		;キュイラス＆かぼちゃパンツ
		R = 111
	ENDIF
	;初期装備：ソード
	CFLAG:A:550 = 40
ELSEIF TALENT:A:206 && TALENT:A:122
	;オトコ巫女
	;巫女装束
	R = 104
	;初期装備：スタッフ
	CFLAG:A:550 = 41
ELSEIF TALENT:A:206
	;巫女
	;巫女装束
	R = 104
	;初期装備：スタッフ
	CFLAG:A:550 = 41
ELSEIF TALENT:A:207 && TALENT:A:122
	;オトコ忍者
	;忍者装束
	R = 110
	;初期装備：シュリケン
	CFLAG:A:550 = 44
ELSEIF TALENT:A:207
	;忍者
	;忍者装束
	R = 110
	;初期装備：シュリケン
	CFLAG:A:550 = 44
ELSEIF TALENT:A:208 && TALENT:A:122
	;オトコ弓師
	;冒険服
	R = 103
	;初期装備：アロー
	CFLAG:A:550 = 45
ELSEIF TALENT:A:208
	;弓師
	IF RAND:3 == 0
		;スキン＆スカートアーマー
		R = 5
	ELSEIF RAND:2 == 0
		;タイツアーマー
		R = 251
	ELSE
		;冒険服
		R = 103
	ENDIF
	;初期装備：アロー
	CFLAG:A:550 = 45
ELSE
	R = 1
	;初期装備：ウィップ
	CFLAG:A:550 = 42
ENDIF

;初期装備接頭語
CFLAG:A:550 += RAND:10 * 100000

CFLAG:A:41 = R
CFLAG:A:45 = 0
CFLAG:A:46 = 0
R = 0
X = TARGET
TARGET = A
CALL WEARING_CLOTH_ABLE
TARGET = X
;近視で眼鏡付き
SIF TALENT:A:48 == 1
	CFLAG:A:42 = 83

;ドワーフとホビットの処理はLOOK.ERBの種族決定時($RACE)に移動



RETURN 0

;---------------------------------------------------------
@CHAR_MAKE_INPORT, ARG:0 = 1
#DIM CHARA, 1
#DIM LIST, 100
#DIMS NUMS, 10
#LOCALSIZE 4
;---------------------------------------------------------
;他の勇者の登場設定
SIF FLAG:76 <= 0
	RETURN 0
;引数ARG:0に応じて生成に成功するか判定
;引数を指定しない場合はRAND(1)=0で必ず成功
SIF RAND(ARG:0) != 0
	RETURN 0
VARSET LIST, -100
LOCAL:1 = 0

FOR LOCAL, 0, 100
	SIF GLOBALS:LOCAL == ""
		CONTINUE
	SPLIT GLOBALS:(LOCAL:1), "_", RESULTS
	SIF TOINT(RESULTS:2) > FLAG:76
		CONTINUE
	FOR LOCAL:2, 0, CHARANUM
		LOCAL:3 = 0
		IF CFLAG:(LOCAL:2):190 == TOINT(RESULTS)
			LOCAL:3 = 1
			BREAK
		ENDIF
	NEXT
	SIF LOCAL:3
		CONTINUE
	;同一のキャラ番号を持つキャラがいる場合ははじく
	SIF GETCHARA(TOINT(RESULTS:1), 0) >= 0
		CONTINUE
	LIST:(LOCAL:1) = LOCAL
	LOCAL:1++
NEXT

;作成可能な勇者がいない
SIF !LOCAL:1
	RETURN 0

;キャラ確定
SPLIT GLOBALS:(LIST:(RAND:(LOCAL:1))), "_", LOCALS
;空白キャラを作成
ADDVOIDCHARA
CHARA = CHARANUM - 1
;キャラ番号
NO:CHARA = TOINT(LOCALS:1)
;名前の設定
SAVESTR:CHARA = %LOCALS:3%
CALLNAME:CHARA = CSVCALLNAME(NO:CHARA, 0)
NAME:CHARA = CALLNAME(NO:CHARA, 0)
;ABL
SPLIT LOCALS:4, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	ABL:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:5, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	BASE:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:6, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	MAXBASE:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:7, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	CFLAG:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:8, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	EXP:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:9, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	EQUIP:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:10, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	JUEL:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:11, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	TALENT:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:12, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	MARK:CHARA:TOINT(NUMS) = TOINT(NUMS:1)
NEXT
SPLIT LOCALS:13, "/", RESULTS
FOR LOCAL, 0, RESULT-1
	SPLIT RESULTS:LOCAL, ",", NUMS
	CSTR:CHARA:TOINT(NUMS) = %NUMS:1%
NEXT

;侵入階層・侵攻度・侵攻中設定
CFLAG:CHARA:501 = 1
CFLAG:CHARA:502 = 0
CFLAG:CHARA:1 = 2
IF FLAG:77
	;レベル・経験値設定
	CFLAG:CHARA:9 = 1
	EXP:CHARA:80 = 0
	IF FLAG:60 > 0
		REPEAT FLAG:60
			CALL ST_UP, CHARA
		REND
	ENDIF
ENDIF
BASE:CHARA:0 = MAXBASE:CHARA:0
BASE:CHARA:1 = MAXBASE:CHARA:1
;一応
RETURN CHARA

@RAND_CHARA_MAKE
#DIM CHARA, 1
#DIM ID_OF_NEWCHARA
#DIM TEMP
#DIM HAIRCOLOR
#DIM CHARACTER
$INPUT_LOOP_11
;キャラのNOを選定
CHARA = RAND(1, 17)
;GETCHARA(キャラ番号, SPフラグ)でキャラが存在しない場合は-1
;存在する場合はキャラ登録番号が帰る
IF GETCHARA(CHARA, 0) == -1
	;異国の勇者の判定をする
	CALL CHAR_MAKE_INPORT
	IF RESULT == 0
		;異国の勇者ではない
		LOCAL:0 = 0
		ADDCHARA CHARA
		A = CHARANUM - 1
		ID_OF_NEWCHARA = CHARANUM - 1
		;性格
		IF CHARACTER != -1
			CALL SET_CHARASTERISTIC(ID_OF_NEWCHARA, CHARACTER)
		ENDIF
		;髪色
		IF HAIRCOLOR > 0
			CALL SET_HAIRCOLOR(ID_OF_NEWCHARA, HAIRCOLOR)
		ENDIF
		
		
		$INPUT_LOOP_12
		PRINTL Surely, the hero that stood before us...
		PRINT [0] Personality: 
		;性格表示、未定義ならランダムに設定
		CALL SHOW_CHARASTERISTIC(ID_OF_NEWCHARA)
		IF RESULT == -1
			CALL SET_RANDOM_CHARASTERISTIC(ID_OF_NEWCHARA)
			CALL SHOW_CHARASTERISTIC(ID_OF_NEWCHARA)
		ENDIF
		CHARACTER = RESULT
		PRINTL
		
		PRINT [1] Hair Color: 
		;髪色表示、未定義ならランダムに設定
		CALL SHOW_HAIRCOLOR(ID_OF_NEWCHARA)
		IF RESULT == 0
			CALL SET_RANDOM_HAIRCOLOR(ID_OF_NEWCHARA)
			CALL SHOW_HAIRCOLOR(ID_OF_NEWCHARA)
		ENDIF
		HAIRCOLOR = RESULT
		PRINTL
		
		DRAWLINE
		PRINTL [100] ...is supposed to be this kind of woman
		
		INPUT
		
		IF RESULT == 0
			;性格変更
			PRINTL What kind of behavior did she show?
			CALL CHOOSE_CHARASTERISTIC(ID_OF_NEWCHARA)
			GOTO INPUT_LOOP_12
			
		ELSEIF RESULT == 1
			;髪色変更
			PRINTL What color was her hair?
			CALL CHOOSE_HAIRCOLOR(ID_OF_NEWCHARA)
			GOTO INPUT_LOOP_12
			
		ELSEIF RESULT == 100
			;進む
		ELSE
			GOTO INPUT_LOOP_12
		ENDIF
		
		;派遣奴隷フラグ(レベル1生成)
		FLAG:402 = 1
		CALL CHAR_MAKE,999,999
		
	ELSE
		;異国の勇者である
		LOCAL:0 = 1
	ENDIF
	
	;キャラのステータス表示
	CALL SHOW_CHARA_INFO, ID_OF_NEWCHARA
	
	PRINTL Was the brave hero this kind of woman...?
	PRINTL [1] I have a feeling it was different  [2] That's correct
	INPUT
	IF RESULT == 1
		CALL PARTY_CHAR_DEL, (CHARANUM - 1)
		DELCHARA (CHARANUM - 1)
		CALL NAME_RESET
		GOTO INPUT_LOOP_11
	ELSE
	PRINTL ****************************************************
	PRINT The 
	SIF LOCAL:0
		PRINT foreign
	PRINT adventurer, 
	PRINTS SAVESTR:(CHARANUM - 1)
	PRINTL , was confined to the dungeon!
	PRINTL ****************************************************
	CFLAG:(CHARANUM - 1):1 = 0
	;使ったフラグを戻しておく
	FLAG:402 = 0
	WAIT
	ENDIF
ELSE
	PRINTL Many heroes fear the Demon King, and no challenger appeared.
	WAIT
	RETURN 0
ENDIF

RETURN (CHARANUM - 1)

