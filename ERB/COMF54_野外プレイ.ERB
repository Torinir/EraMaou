;eraIM@Sから導入しました(eramaou)

@COM54
;野外プレイ

PRINTL 野外プレイ
;SAVESTR:22 = 野外プレイ
CALL TRAIN_MESSAGE_B

;屋外への出入り
;終了時は修正なし
IF TEQUIP:54
	TEQUIP:54 = 0
	RETURN 1
ENDIF

LOSEBASE:0 += 0
LOSEBASE:1 += 150

A = 500
B = 500

;PALAM:欲情をみる
IF PALAM:5 < PALAMLV:1
	TIMES A , 0.80
ELSEIF PALAM:5 < PALAMLV:2
	TIMES A , 0.90
ELSEIF PALAM:5 < PALAMLV:3
	TIMES A , 1.00
ELSEIF PALAM:5 < PALAMLV:4
	TIMES A , 1.10
ELSEIF PALAM:5 >= PALAMLV:4
	TIMES A , 1.20
ENDIF
;ABL:露出癖をみる
IF ABL:17 == 0
	SOURCE:7 += 0
	SOURCE:10 += 0
	TIMES A, 1.00
ELSEIF ABL:17 == 1
	SOURCE:7 += 50
	SOURCE:10 += 50
	TIMES A, 1.20
ELSEIF ABL:17 == 2
	SOURCE:7 += 150
	SOURCE:10 += 150
	TIMES A, 1.40
ELSEIF ABL:17 == 3
	SOURCE:7 += 400
	SOURCE:10 += 400
	TIMES A, 1.60
ELSEIF ABL:17 == 4
	SOURCE:7 += 750
	SOURCE:10 += 750
	TIMES A, 2.00
ELSE
	SOURCE:7 += 1300
	SOURCE:10 += 1300
	TIMES A, 3.00
ENDIF
;ABL:マゾっ気をみる
IF ABL:21 == 0
	TIMES A , 0.80
ELSEIF ABL:21 == 1
	TIMES A , 1.00
ELSEIF ABL:21 == 2
	TIMES A , 1.30
ELSEIF ABL:21 == 3
	TIMES A , 1.60
ELSEIF ABL:21 == 4
	TIMES A , 2.00
ELSE
	TIMES A , 3.00
ENDIF

;目立ちたがり
SIF TALENT:28
	TIMES A , 1.50
;解放
SIF TALENT:33
	TIMES A , 1.50

;臆病
SIF TALENT:10
	TIMES B , 2.00
;恥じらい
SIF TALENT:35
	TIMES B , 2.00

;露出狂
IF TALENT:89
	TIMES A , 2.00
	TIMES B , 0.50
ENDIF

SOURCE:12 += A
SOURCE:14 += B
SOURCE:16 += A/2

TEQUIP:54 = 1

;野外プレイが始めての場合
IF TEQUIP:54 && CFLAG:5 == 0
	PRINTFORML 異常経験+1
	EXP:50 += 1
	CFLAG:5 = 1
ENDIF

RETURN 1

@EQUIP_COM54
;野外プレイ

PRINTL <野外プレイ中>

LOSEBASE:0 += 50
LOSEBASE:1 += 100

A = 500
B = 500

;PALAM:欲情をみる
IF PALAM:5 < PALAMLV:1
	TIMES A , 0.80
ELSEIF PALAM:5 < PALAMLV:2
	TIMES A , 0.90
ELSEIF PALAM:5 < PALAMLV:3
	TIMES A , 1.00
ELSEIF PALAM:5 < PALAMLV:4
	TIMES A , 1.10
ELSEIF PALAM:5 >= PALAMLV:4
	TIMES A , 1.20
ENDIF
;ABL:露出癖をみる
IF ABL:17 == 0
	SOURCE:7 += 0
	SOURCE:10 += 0
	TIMES A, 1.00
ELSEIF ABL:17 == 1
	SOURCE:7 += 50
	SOURCE:10 += 50
	TIMES A, 1.20
ELSEIF ABL:17 == 2
	SOURCE:7 += 150
	SOURCE:10 += 150
	TIMES A, 1.40
ELSEIF ABL:17 == 3
	SOURCE:7 += 400
	SOURCE:10 += 400
	TIMES A, 1.60
ELSEIF ABL:17 == 4
	SOURCE:7 += 750
	SOURCE:10 += 750
	TIMES A, 2.00
ELSE
	SOURCE:7 += 1300
	SOURCE:10 += 1300
	TIMES A, 3.00
ENDIF
;ABL:マゾっ気をみる
IF ABL:21 == 0
	TIMES A , 0.80
ELSEIF ABL:21 == 1
	TIMES A , 1.00
ELSEIF ABL:21 == 2
	TIMES A , 1.30
ELSEIF ABL:21 == 3
	TIMES A , 1.60
ELSEIF ABL:21 == 4
	TIMES A , 2.00
ELSE
	TIMES A , 3.00
ENDIF

;目立ちたがり
SIF TALENT:28
	TIMES A , 1.50
;解放
SIF TALENT:33
	TIMES A , 1.50

;臆病
SIF TALENT:10
	TIMES B , 2.00
;恥じらい
SIF TALENT:35
	TIMES B , 2.00
;露出狂
IF TALENT:89
	TIMES A , 2.00
	TIMES B , 0.50
ENDIF

SOURCE:12 += A
SOURCE:14 += B
SOURCE:16 += A/2

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +1
	EXP:40 += 1
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +1
	EXP:41 += 1
ENDIF

SIF ASSIPLAY == 0 && ABL:17 >= 3
	TFLAG:30 += 1

RETURN 1
