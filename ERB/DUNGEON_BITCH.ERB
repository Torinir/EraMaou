;ダンジョン内でのイベント奴隷用
;--------------------------------------
@DUNGEON_BITCH(ARG)
;--------------------------------------
#LOCALSIZE 1
#LOCALSSIZE 1
#DIM SEIKOU
#DIM SIPPAI
SIF BASE:ARG:0 < 300 || BASE:ARG:1 < 100
	RETURN 0

SEIKOU = FI_CULC_BITCH(ARG, "SEIKOU", "DUNGEON")
SIPPAI = FI_CULC_BITCH(ARG, "SIPPAI", "DUNGEON")

;#;PRINTFORMW 売春判定　成功{SEIKOU}　失敗{SIPPAI}

;勇者用
IF CFLAG:ARG:1 == 2
	SIF !EXP:ARG:74
		RETURN 0
	SIF SEIKOU <= 100
		RETURN 0
ENDIF

;売春処理に入る
IF RAND:(SEIKOU + SIPPAI) < SEIKOU
	CALL LOG_TRY_BITCH(ARG, "DUNGEON")
	CALL SELL_BITCH(ARG, "DUNGEON")
ENDIF


;獣
IF RAND(1, 16) < ABL:ARG:39
	SIF FI_CULC_BITCH(ARG, "ABLE", "ANIMAL")
		CALL DUNGEON_ANIMAL(ARG)
ENDIF

;おな
IF RAND:36 <= ABL:ARG:11 + ABL:ARG:31 + (TALENT:ARG:60 * 10)
	SIF FI_CULC_BITCH(ARG, "ABLE", "SELF")
		CALL SELF_BITCH(ARG, "DUNGEON")
ENDIF

;ついでに内職
SIF CFLAG:ARG:500 == 0 && CFLAG:ARG:1 == 3
	CALL DUNGEON_WORK(ARG)



;ダンジョン外で勇者が売春する用
;--------------------------------------
@HEROINE_BITCH(ARG)
;--------------------------------------
#LOCALSIZE 1
#LOCALSSIZE 1
#DIM SEIKOU
#DIM SIPPAI
SIF BASE:ARG:0 < 300 || BASE:ARG:1 < 100
	RETURN 0

SEIKOU = FI_CULC_BITCH(ARG, "SEIKOU", "TOWN")
SIPPAI = FI_CULC_BITCH(ARG, "SIPPAI", "TOWN")

;#;PRINTFORMW 売春判定　成功{SEIKOU}　失敗{SIPPAI}

;売春処理に入る
IF SEIKOU > 100 && RAND:(SEIKOU + SIPPAI) < SEIKOU
	CALL LOG_TRY_BITCH(ARG, "TOWN")
	CALL SELL_BITCH(ARG, "TOWN")
ENDIF

;おな
IF RAND:36 <= ABL:ARG:11 + ABL:ARG:31 + (TALENT:ARG:60 * 10)
	SIF FI_CULC_BITCH(ARG, "ABLE", "SELF")
		CALL SELF_BITCH(ARG, "TOWN")
ENDIF



;売春実行関数
;DUNGEON_BITCHから受け継いでのやっつけネームでいいや的関数名
;PLAYは各プレイ内容の実行回数
;MANは男性客の,GIRLは女性客の種類と数
;PREV系は売春前の各種変数の記録用

;CHECKはBIT利用で売春の内容を記録(描写分岐用)
;0 　　　=0でTOWN/1でDUNGEON
;1～6　　プレイの有無(1:HAND, 2:ORAL, 3:LES, 4:ANAL, 5:SEX, 6:ANIMAL)
;11～15　男性客の有無
;21～25　女性客の有無
@SELL_BITCH(ARG, PLACE)
#LOCALSIZE 1
#LOCALSSIZE 1
#DIMS PLACE
#DIM LCOUNT
#DIM KYAKU
#DIM SEIKOU
#DIM SIPPAI
#DIM PLAY, 7
#DIM MAN, 6
#DIM GIRL, 6
#DIM PREV_EXP, 100
#DIM PREV_JUEL, 20
#DIM PREV_KARMA
#DIM PREV_MONEY
#DIM CHECK
KYAKU = FI_CULC_BITCH(ARG, "KYAKU", PLACE)
;客がいる(客というか判定回数)
IF KYAKU
	VARSET PLAY
	VARSET MAN
	VARSET GIRL
	VARSET CHECK
	
	;現状の取得
	;ARRAYCOPYはキャラクタ変数に使えないのか---
	FOR LCOUNT, 0, 100
		PREV_EXP:LCOUNT = EXP:ARG:LCOUNT
	NEXT
	FOR LCOUNT, 0, 20
		PREV_JUEL:LCOUNT = JUEL:ARG:LCOUNT
	NEXT
	PREV_KARMA = CFLAG:ARG:151
	
	IF PLACE == "DUNGEON"
		SETBIT CHECK, 0
		;侵攻中の勇者
		IF CFLAG:ARG:1 == 2
			PREV_MONEY = CFLAG:ARG:580
		ELSE
			PREV_MONEY = MONEY
		ENDIF
	ELSE
		PREV_MONEY = CFLAG:ARG:580
	ENDIF
	;このループ内でカルマを下げるとどんどん判定が緩くなっていってしまうので
	;ひととおり終わってから下げるようにする
	FOR LCOUNT, 0, KYAKU
		;勇者側は資金状況の変化から基本成功率が変化する
		SEIKOU = FI_CULC_BITCH(ARG, "SEIKOU", PLACE)
		SIPPAI = FI_CULC_BITCH(ARG, "SIPPAI", PLACE)
		SIF RAND:(SEIKOU + SIPPAI) >= SEIKOU
			CONTINUE
		
		;プレイ内容決定
		LOCAL = FI_TRY_BITCH(ARG, PLACE)
		;システムメッセージかな,とコメントアウトしてみました
		;PRINTFORMW 客{LCOUNT + 1}内容は{LOCAL}
		;売春失敗
		SIF !LOCAL
			CONTINUE
		;プレイ内容の文字列化
		LOCALS = %FS_BITCH("PLAY", LOCAL)%
		
		;たぶん大丈夫だが一応確認
		SIF !FI_CULC_BITCH(ARG, "ABLE", LOCALS)
			CONTINUE
		
		
		;今回のプレイ回数
		PLAY = FI_CULC_BITCH(ARG, "PLAY", LOCALS)
		PLAY:LOCAL += PLAY
		SETBIT CHECK, LOCAL
		
		;顧客の記録が若干ややこしいがしゃーない
		CALL PROFIT_BITCH(ARG, PLACE, LOCALS, PLAY)
		SELECTCASE RESULT
		;男性客
		CASE 1
			MAN = RESULT:1
			MAN:MAN ++
			SETBIT CHECK, (10 + MAN)
		;女性客
		CASE 2
			GIRL = RESULT:1
			GIRL:GIRL ++
			SETBIT CHECK, (20 + GIRL)
		ENDSELECT
		
		CALL EXP_BITCH(ARG, PLACE, LOCALS, PLAY)
		
	NEXT
	
	;合計プレイ回数
	PLAY = 0
	PLAY = SUMARRAY(PLAY)
	
	;ここから売春成功の表示
	;使用変数が多くて関数化はむりぽ
	IF PLAY > 0
		;客とプレイ回数の表示
		MAN = 0
		MAN = SUMARRAY(MAN)
		GIRL = 0
		GIRL = SUMARRAY(GIRL)
		
		;ダンジョン
		IF PLACE == "DUNGEON"
			PRINTFORM %SAVESTR:ARG%は
			VARSET LOCALS
			SIF MAN
				LOCALS = %FS_LOG_BITCH("DUNGEON_MAN", MAN:1, MAN:2, MAN:3, MAN:4, MAN:5)%
			
			IF GIRL
				IF MAN
					PRINTFORML %LOCALS%,
					PRINTFORM そして,
				ENDIF
				LOCALS = %FS_LOG_BITCH("DUNGEON_GIRL", GIRL:1, GIRL:2, GIRL:3, GIRL:4, GIRL:5)%
			ENDIF
			PRINTFORML %LOCALS%を相手に
			
			LOCALS = %FS_LOG_BITCH("PLAYNAME", PLAY:1, PLAY:2, PLAY:3, PLAY:4, PLAY:5)%
			PRINTFORMW %LOCALS%を行った
		;街中
		ELSE
			PRINTFORM %SAVESTR:ARG%は
			VARSET LOCALS
			IF PLAY == PLAY:6
				PRINTFORMW 獣姦ショ-に{PLAY:6}回出演した
			ELSE
				SIF MAN
					LOCALS = %FS_LOG_BITCH("TOWN_MAN", MAN:1, MAN:2, MAN:3, MAN:4, MAN:5)%
				IF GIRL
					IF MAN
						PRINTFORML %LOCALS%,
						PRINTFORM そして,
					ENDIF
					LOCALS = %FS_LOG_BITCH("TOWN_GIRL", GIRL:1, GIRL:2, GIRL:3, GIRL:4, GIRL:5)%
				ENDIF
				PRINTFORML %LOCALS%を相手に
				
				LOCALS = %FS_LOG_BITCH("PLAYNAME", PLAY:1, PLAY:2, PLAY:3, PLAY:4, PLAY:5)%
				PRINTFORMW %LOCALS%を行った
				IF PLAY:6
					PRINTFORMW ...さらに獣姦ショ-に{PLAY:6}回出演した
				ENDIF
			ENDIF
		ENDIF
		;カルマの減少
		LOCAL = -1 * PLAY
		CALL KARMA, ARG, LOCAL
		
		CALL LOG_AFTER_BITCH(ARG, CHECK)
		
		PRINTFORML ～経験と珠の変化～
		FOR LCOUNT, 0, 100
			SIF PREV_EXP:LCOUNT == EXP:ARG:LCOUNT
				CONTINUE
			PRINTFORML %EXPNAME:LCOUNT, 16, RIGHT%:{PREV_EXP:LCOUNT, 30, RIGHT}→{EXP:ARG:LCOUNT, 30, RIGHT}
		NEXT
		FOR LCOUNT, 0, 20
			SIF PREV_JUEL:LCOUNT == JUEL:ARG:LCOUNT
				CONTINUE
			PRINTFORML %PALAMNAME:LCOUNT, 12, RIGHT%の珠:{PREV_JUEL:LCOUNT, 30, RIGHT}→{JUEL:ARG:LCOUNT, 30, RIGHT}
		NEXT
		WAIT
		
		IF PLACE == "DUNGEON"
			EXP:0:80 += PLAY
			EXP:ARG:80 += PLAY
			PRINTFORMW %SAVESTR:ARG%の逸脱は魔王と奴隷の力となった(経験値+{PLAY})
			;侵攻中の勇者
			IF CFLAG:ARG:1 == 2
				LOCAL = CFLAG:ARG:580 - PREV_MONEY
				PRINTFORMW %SAVESTR:ARG%は{LOCAL}の代金を入手した
			ELSE
				;奴隷側の財布にも入るように
				LOCAL = MONEY - PREV_MONEY
				IF LOCAL % 2
					LOCAL /= 2 + 1
				ELSE
					LOCAL /= 2
				ENDIF
				MONEY -= LOCAL
				CFLAG:ARG:580 += LOCAL
				PRINTFORMW %SAVESTR:ARG%は売上げの半分にあたる{LOCAL}の資金を献上してきた
			ENDIF
		ELSE
			LOCAL = CFLAG:ARG:580 - PREV_MONEY
			EXP:ARG:80 += LOCAL
			PRINTFORMW %SAVESTR:ARG%は代金を{LOCAL}入手し,経験値を同量得た
		ENDIF
		
		LOCAL = PREV_KARMA - CFLAG:ARG:151
		SIF LOCAL
			PRINTFORMW そしてカルマが{ABS(LOCAL)}減少した
		
	;いちども成功しなかった
	ELSE
		IF !EXP:ARG:74 && CFLAG:ARG:151 > 100
			PRINTFORMW すぐに%SAVESTR:ARG%は我に返り,破廉恥な思いつきを頭から追い払った
		ELSEIF CFLAG:ARG:151 > 50
			PRINTFORMW 踏ん切りがつかず悩んでいる間に時間ばかりが過ぎていく...
		ELSEIF CFLAG:ARG:151 > 0
			PRINTFORMW しかし,声をかける勇気が出せず,実際に売春におよぶことはなかった
		ELSE
			PRINTFORM {KYAKU}人に声をかけたものの,
			PRINTFORMW 交渉の末,ひとりも%SAVESTR:ARG%を買うことなく立ち去ってしまった
		ENDIF
	ENDIF
;客はこなかった
ELSE
		IF !EXP:ARG:74 && CFLAG:ARG:151 > 100
		PRINTFORMW すぐに%SAVESTR:ARG%は我に返り,破廉恥な思いつきを頭から追い払った
	ELSEIF CFLAG:ARG:151 > 50
		PRINTFORMW 踏ん切りがつかず悩んでいる間に時間ばかりが過ぎていく...
	ELSEIF CFLAG:ARG:151 > 0
		PRINTFORMW しかし,声をかける勇気が出せず,実際に売春におよぶことはなかった
	ELSE
		PRINTFORMW しかし,誰にも相手にされなかった
	ENDIF
ENDIF


;売春経験関数
;売春によるEXPやJUELの変化
;売上,経験値,カルマはまた別で行う
@EXP_BITCH(ARG, PLACE, TYPE, PLAY)
#LOCALSIZE 1
#LOCALSSIZE 1
#DIMS PLACE
#DIMS TYPE
#DIM PLAY
SELECTCASE TYPE
CASE "HAND"
	EXP:ARG:20 += PLAY
	EXP:ARG:74 += PLAY
	IF PLACE == "DUNGEON"
		JUEL:ARG:7 += PLAY * 5
	ELSE
		JUEL:ARG:7 += PLAY
	ENDIF
	SIF TALENT:ARG:62
		JUEL:ARG:9 += PLAY
	SIF TALENT:ARG:47
		JUEL:ARG:5 += PLAY * 5
CASE "ORAL"
	EXP:ARG:22 += PLAY
	EXP:ARG:20 += PLAY
	EXP:ARG:74 += PLAY
	IF PLACE == "DUNGEON"
		JUEL:ARG:7 += PLAY * 10
	ELSE
		JUEL:ARG:7 += PLAY
	ENDIF
	SIF TALENT:ARG:62
		JUEL:ARG:9 += PLAY
	IF TALENT:ARG:47
		EXP:8 += PLAY
		JUEL:ARG:5 += PLAY * 10
	ENDIF
CASE "LES"
	EXP:ARG:40 += PLAY
	EXP:ARG:74 += PLAY
	IF PLACE == "DUNGEON"
		EXP:ARG:2 += PLAY * (1 + ABL:ARG:10) / 5
		JUEL:ARG:0 += PLAY * 100 * (1 + ABL:ARG:10)
		JUEL:ARG:5 += PLAY * 200
	ELSE
		EXP:ARG:2 += PLAY * (1 + ABL:ARG:10) / 10
		JUEL:ARG:0 += PLAY * 10 * ABL:ARG:10
		JUEL:ARG:5 += PLAY * 15
	ENDIF
CASE "ANAL"
	EXP:ARG:1 += PLAY
	EXP:ARG:5 += PLAY
	EXP:ARG:74 += PLAY
	IF PLACE == "DUNGEON"
		JUEL:ARG:2 += PLAY * 200
		JUEL:ARG:5 += PLAY * 250
	ELSE
		JUEL:ARG:2 += PLAY * 10
		JUEL:ARG:5 += PLAY * 15
	ENDIF
CASE "SEX"
	EXP:ARG:0 += PLAY
	EXP:ARG:5 += PLAY
	EXP:ARG:74 += PLAY
	IF PLACE == "DUNGEON"
		JUEL:ARG:1 += PLAY * 200
		JUEL:ARG:5 += PLAY * 250
	ELSE
		JUEL:ARG:1 += PLAY * 10
		JUEL:ARG:5 += PLAY * 15
	ENDIF
CASE "ANIMAL"
	EXP:56 += PLAY
	EXP:0 += PLAY
	EXP:5 += PLAY
	JUEL:1 += PLAY * 200
	JUEL:6 += PLAY * 300
	JUEL:8 += PLAY * 200
	;自分の趣味から外れているしよくわからんけど現状では差異がなかったぞ
	;IF PLACE == "DUNGEON"
	;ELSE
	;ENDIF
ENDSELECT




;売春利益関数
;戻り値で顧客の種類を返す
@PROFIT_BITCH(ARG, PLACE, TYPE, PLAY)
#LOCALSIZE 1
#LOCALSSIZE 1
#DIMS PLACE
#DIMS TYPE
#DIM PLAY
#DIM PAY
#DIM GIRL
#DIM MAN
;今回の基本料金
IF PLACE == "DUNGEON"
	;勇者
	IF CFLAG:ARG:1 == 2
		PAY = (FI_CULC_BITCH(ARG, "RATE", TYPE) + CFLAG:ARG:501) * FI_CULC_BITCH(ARG, "RATE", "KARMA") / 5
	;奴隷
	ELSE
		PAY = 5 * (1 + CFLAG:ARG:501 + FI_CULC_BITCH(ARG, "RATE", TYPE))
	ENDIF
ELSE
	PAY = FI_CULC_BITCH(ARG, "RATE", "KARMA") * FI_CULC_BITCH(ARG, "RATE", TYPE) / 5
ENDIF

SELECTCASE TYPE
;わんわん
CASE "ANIMAL"
;れず
CASE "LES"
	GIRL = RAND(1, 6)
	SELECTCASE GIRL
	CASE 3
		PAY -= 10
	CASE 4
		PAY += 10
	ENDSELECT
CASEELSE
	MAN = RAND(1, 6)
	SELECTCASE MAN
	CASE 3
		PAY -= 10
	CASE 4
		PAY += 10
	ENDSELECT
ENDSELECT

SIF !EXP:ARG:74
	PAY += 10

SIF TALENT:ARG:0
	PAY += 5

PAY = PAY * PLAY

;お支払い
IF PLACE == "DUNGEON"
	;侵攻中の勇者
	IF CFLAG:ARG:1 == 2
		CFLAG:ARG:580 += PAY
	ELSE
		MONEY += PAY
	ENDIF
ELSE
	CFLAG:ARG:580 += PAY
ENDIF

SELECTCASE TYPE
CASE "ANIMAL"
	RETURN 0
CASE "LES"
	RETURN 2, GIRL
CASEELSE
	RETURN 1, MAN
ENDSELECT



;内職実行関数
@DUNGEON_WORK(ARG)
#LOCALSIZE 1
#LOCALSSIZE 1
LOCAL = (CFLAG:ARG:9 * 20) + 100
SIF CFLAG:ARG:0 == 0
	LOCAL /= 10
IF FLAG:5 & 32
	PRINTFORM %SAVESTR:ARG%は
	PRINTDATA
		DATAFORM 宝石磨き
		DATAFORM 細工物
		DATAFORM 写本
		DATAFORM 手芸
	ENDDATA
	PRINTFORMW の内職で{LOCAL}の収入を得た
ENDIF
MONEY += LOCAL



;自主獣姦実行関数
;処理はあまり変えてないがカルマの減りがでかくなった
@DUNGEON_ANIMAL(ARG)
#LOCALSIZE 1
#LOCALSSIZE 1
#DIM PLAY
PLAY = FI_CULC_BITCH(ARG, "PLAY", "ANIMAL")
PRINTFORM %SAVESTR:ARG%は獣姦への欲望を抑えきれず
PRINTFORMW 野獣のモンスタ-と{PLAY}回の交尾を行ったらしい

CALL LOG_BITCH_ANIMAL(ARG, "DUNGEON")
WAIT

;獣姦経験
PRINTFORML %EXPNAME:56%+{PLAY}
PRINTFORML %EXPNAME:0%+{PLAY}
PRINTFORML %EXPNAME:5%+{PLAY}
EXP:ARG:56 += PLAY
EXP:ARG:0 += PLAY
EXP:ARG:5 += PLAY

;珠経験
PRINTFORML %PALAMNAME:1%の珠+{PLAY*200}
PRINTFORML %PALAMNAME:6%の珠+{PLAY*300}
PRINTFORMW %PALAMNAME:8%の珠+{PLAY*200}
JUEL:ARG:1 += PLAY * 200
JUEL:ARG:6 += PLAY * 300
JUEL:ARG:8 += PLAY * 200

PRINTFORMW %SAVESTR:ARG%の逸脱は魔王と奴隷の力となった(経験値+{PLAY})
EXP:0:80 += PLAY
EXP:ARG:80 += PLAY

LOCAL = -1 * PLAY
PRINTFORMW (カルマが減少しました:{LOCAL})
CALL KARMA, TARGET, LOCAL



;自慰実行関数
@SELF_BITCH(ARG, PLACE)
#LOCALSIZE 1
#LOCALSSIZE 1
#DIMS PLACE
#DIM PLAY
PRINTFORMW %SAVESTR:ARG%は欲望を抑えきれず自慰を始めてしまった
PLAY = FI_CULC_BITCH(ARG, "PLAY", "SELF")

;調教後オナニーの妄想の相手
;愛がなくかつレズっ気×20%でレズ
IF !TALENT:ARG:85 && ABL:ARG:22 > RAND:5
	PRINTFORM レズセックスを妄想しながら
	LOCAL = 1
;上に該当せずかつ愛がなくアイテムに野良犬があれば,獣姦中毒×20%で野良犬
ELSEIF ITEM:22 && !TALENT:ARG:85 && ABL:ARG:39 > RAND:5
	PRINTFORM 野獣との交尾を妄想しながら
	LOCAL = 2
;ダンジョン限定で主人
;調教回数依存(20回で50％,40回で必中)
ELSEIF PLACE == "DUNGEON" && RAND(1, 40) < CFLAG:ARG:10
	PRINTDATA
		DATAFORM %CALLNAME:MASTER%の事を想いながら
		DATAFORM 何度も%CALLNAME:MASTER%の名を呟きながら
		DATAFORM 前回の調教を思い出しながら
		DATAFORM 次回の調教を妄想しながら
	ENDDATA
	LOCAL = 3
;夢中で
;自慰中毒依存,5以上で必ず夢中
ELSEIF RAND(1, 5) < ABL:ARG:31
	PRINTDATA
		DATAFORM 貪るようにはげしく
		DATAFORM もどかしそうにせわしなく
		DATAFORM だらしなく口を開けたまま
		DATAFORM よだれがしたたるのも気にせずに
		DATAFORM よだれが垂れるのにも気づかずに
		DATAFORM 惚けたような表情で
		DATAFORM 快楽に融けた表情で
		DATAFORM 肌を朱に染めながら
		DATAFORM 火照った身体を持て余して
		DATAFORM とろんとした目つきで
		DATAFORM 情欲に潤みきった目つきで
		DATAFORM ピンと脚を突っ張りながら
		DATAFORM ビクンと身ぶるいをしながら
		DATAFORM 股を大きく開いたままで
		DATAFORM いつしか腰を浮かせながら
		DATAFORM 物欲しげに腰を揺らしながら
		DATAFORM いやらしく腰をくねらせながら
		DATAFORM 喉を反らせながら
		DATAFORM ときおり声を漏らしながら
		DATAFORM 夜具をしとどに濡らしつつ
		DATAFORM 溢れ出る愛液を塗り込めながら
		DATAFORM はしたなく衣服をはだけて
		DATAFORM 絶頂を先延ばしにしながら
	ENDDATA
	LOCAL = 4
;控えめに
ELSE
	PRINTDATA
		DATAFORM 必死で声を殺しながら
		DATAFORM 懸命に息を潜めながら
		DATAFORM 物音を気にしながら
		DATAFORM やめようと思いながらも
		DATAFORM ためらいまじりの手つきで
		DATAFORM 迷いがちに指を這わせて
		DATAFORM 固く唇を引き結んだまま
		DATAFORM 物憂げに目を伏せて
		DATAFORM 悩ましげに眉をひそめて
	ENDDATA
	LOCAL = 5
ENDIF

IF TALENT:ARG:121 == 1 || TALENT:ARG:122 == 1 || TALENT:ARG:326 == 1
	;ふたなり-オトコ-肉芽
	PRINT ペニスをしごき
ENDIF

PRINTFORMW {PLAY}回の自慰をしたようだ

;調子に乗って↑でこんだけパターンつくったらもういいような気もする
CALL LOG_BITCH_SELF(ARG, PLACE, LOCAL)
WAIT

;自慰経験
PRINTFORML %EXPNAME:10%+{PLAY}
EXP:ARG:10 += PLAY

;珠経験
PRINTFORML %PALAMNAME:0%の珠+{PLAY * 500}
PRINTFORML %PALAMNAME:4%の珠+{PLAY * 100}
PRINTFORMW %PALAMNAME:5%の珠+{PLAY * 250}
JUEL:ARG:0 += PLAY * 500
JUEL:ARG:4 += PLAY * 100
JUEL:ARG:5 += PLAY * 250

IF PLACE == "DUNGEON"
	EXP:ARG:80 += PLAY
	EXP:0:80 += PLAY
	PRINTFORMW %SAVESTR:ARG%の逸脱は魔王と奴隷の力となった(経験値+{PLAY})
ELSE
	EXP:ARG:80 += PLAY
	PRINTFORMW %SAVESTR:ARG%は{PLAY}の経験値を得た
ENDIF




;売春プレイ内容抽選関数
;戻り値0=失敗, 1=HAND, 2=ORAL, 3=LES, 4=ANAL, 5=SEX, 6=ANIMAL
@FI_TRY_BITCH(ARG, PLACE)
#FUNCTION
#DIMS PLACE
#DIM LCOUNT
#DIM PLAY, 7
VARSET PLAY
IF PLACE == "TOWN"
	;確率取得
	FOR LCOUNT, 1, 7
		LOCALS = %FS_BITCH("PLAY", LCOUNT)%
		PLAY:LCOUNT = FI_CULC_BITCH(ARG, "KAKURITU", LOCALS)
		;カルマによる各プレイへの抵抗感の影響,高カルマほど効果は大きい
		PLAY:LCOUNT += FI_CULC_BITCH(ARG, "RATE", "KARMA") / FI_CULC_BITCH(ARG, "RATE", LOCALS)
		;条件に合致しない時はとりあえず0
		SIF !FI_CULC_BITCH(ARG, "ABLE", LOCALS)
			PLAY:LCOUNT = 0
	NEXT
	;カルマで強制失敗
	PLAY:0 = SUMARRAY(PLAY) + FI_CULC_BITCH(ARG, "SIPPAI", "TOWN")
ELSEIF PLACE == "DUNGEON"
	;確率取得
	FOR LCOUNT, 1, 6
		LOCALS = %FS_BITCH("PLAY", LCOUNT)%
		PLAY:LCOUNT = FI_CULC_BITCH(ARG, "KAKURITU", LOCALS)
		;条件に合致しない時はとりあえず0
		SIF !FI_CULC_BITCH(ARG, "ABLE", LOCALS)
			PLAY:LCOUNT = 0
	NEXT
	PLAY:0 = SUMARRAY(PLAY)
	
	;指示分岐
	IF CFLAG:ARG:500 == 1
		PLAY:0 += FI_CULC_BITCH(ARG, "SIPPAI", "DUNGEON") / MAX(1, ABL:ARG:10)
	ELSE
		PLAY:0 += FI_CULC_BITCH(ARG, "SIPPAI", "DUNGEON")
	ENDIF
ENDIF

LOCAL = RAND:PLAY
FOR LCOUNT, 1, 7
	SIF LOCAL < PLAY:LCOUNT
		RETURNF LCOUNT
	LOCAL -= PLAY:LCOUNT
NEXT
RETURNF 0



;売春関連判定関数
;ムダに巨大になった
;もっと切り刻んだほうがいいかもしれぬ
@FI_CULC_BITCH(ARG, ARGS, ARGS:1)
#FUNCTION
#LOCALSIZE 1
#LOCALSSIZE 1
SELECTCASE ARGS
;売春基本失敗率の計算
CASE "SIPPAI"
	;てすと用
	;RETURNF 1
	;この封印を解くとかなりのカオスっぷりがそれはそれでおもしろいぞ
	
	;失敗率＝250±カルマ＝50～450
	;カルマ200の勇者も収支が-10000程度になるとちょくちょく売春する
	IF ARGS:1 == "TOWN"
		LOCAL = 250 + CFLAG:ARG:151
	ELSEIF ARGS:1 == "DUNGEON"
		LOCAL = 250 + CFLAG:ARG:151
	ELSE
		THROW 不明な文字列%ARGS:1%
	ENDIF
	;売春中毒補正
	LOCAL /= (1 + ABL:ARG:37)
	;淫乱
	SIF TALENT:ARG:76
		TIMES LOCAL, 0.7
	;娼婦と傾城
	IF TALENT:ARG:181
		TIMES LOCAL, 0.5
	ELSEIF TALENT:ARG:180
		TIMES LOCAL, 0.7
	ENDIF
	
	;売春禁止
	SIF CFLAG:ARG:120 == 0
		LOCAL += 999
	
	;0にはならない
	LOCAL = MAX(LOCAL, 1)
	RETURNF LOCAL
;売春基本成功率の計算
CASE "SEIKOU"
	LOCAL = ABL:ARG:37 * 5
	SIF EXP:ARG:74
		LOCAL ++
	SIF CFLAG:ARG:151 < -100
		LOCAL ++
	;肉便器補正
	SIF TALENT:ARG:204
		LOCAL += 100
	;淫乱-娼婦-傾城
	LOCAL += (TALENT:ARG:76 + TALENT:ARG:180 + TALENT:ARG:181) * 30
	IF ARGS:1 == "TOWN"
		;基本成功率は所持金依存
		SELECTCASE CFLAG:ARG:580 + CFLAG:ARG:581 + CFLAG:ARG:582
		CASE IS < -40000
			LOCAL += 2000
		CASE IS < -20000
			LOCAL += 1000
		CASE IS < -10000
			LOCAL += 500
		CASE IS < -5000
			LOCAL += 250
		CASE IS < 0
			LOCAL += 100
		CASE IS < 5000
			LOCAL += 50
		CASE IS < 10000
			LOCAL += 20
		CASEELSE
			LOCAL += 5
		ENDSELECT
	ELSEIF ARGS:1 == "DUNGEON"
		;勇者
		IF CFLAG:ARG:1 == 2
			SELECTCASE CFLAG:ARG:580 + CFLAG:ARG:581 + CFLAG:ARG:582
			CASE IS < -40000
				LOCAL += 2000
			CASE IS < -20000
				LOCAL += 1000
			CASE IS < -10000
				LOCAL += 500
			CASE IS < -5000
				LOCAL += 250
			CASE IS < 0
				LOCAL += 100
			CASE IS < 5000
				LOCAL += 50
			CASE IS < 10000
				LOCAL += 20
			CASEELSE
				LOCAL += 5
			ENDSELECT
		;奴隷
		ELSE
			LOCAL += 1500 / (25 - ABL:ARG:11 - ABL:ARG:37)
			;潜入中
			IF CFLAG:ARG:1 == 3 && CFLAG:(ARG:0):533 > 1
				TIMES LOCAL, 0.75
			;売春指示を受けた奴隷
			ELSEIF CFLAG:ARG:500 == 1
				LOCAL *= 10 + ABL:ARG:10 * 2
				LOCAL /= 10
			;それ以外
			ELSE
				TIMES LOCAL, 0.75
			ENDIF
		ENDIF
	ELSE
		THROW 不明な文字列%ARGS:1%
	ENDIF
	
	;売春積極性
	IF CFLAG:ARG:120 > 0
		LOCAL += (CFLAG:ARG:120 * 5) - 5
	ELSE
		LOCAL = 1
	ENDIF
	
	;0にはならない
	LOCAL = MAX(LOCAL, 1)
	RETURNF LOCAL
;とった客の最大人数
CASE "KYAKU"
	LOCAL = RAND:6
	;カルマ補正
	SELECTCASE CFLAG:ARG:151
	CASE IS > 180
		LOCAL -= 3
	CASE IS > 130
		LOCAL -= 2
	CASE IS > 80
		LOCAL -= 1
	CASE IS > 30
	CASE IS > -20
		LOCAL += 1
	CASE IS > -70
		LOCAL += 2
	CASE IS > -120
		LOCAL += 3
	CASEELSE
		LOCAL += 4
	ENDSELECT
	
	;出自による補正
	SELECTCASE TALENT:ARG:315
	CASE 5
	;元娼婦
		LOCAL += 2
	CASE 7
	;元物乞い
		LOCAL += 1
	CASE 2, 8, 12
	;元修道女,元貴族,元聖女
		LOCAL -= 1
	ENDSELECT
	
	LOCAL += (ABL:ARG:15 + ABL:ARG:17 + ABL:ARG:37) / 6
	LOCAL += TALENT:ARG:23 + TALENT:ARG:28 + TALENT:ARG:31 + TALENT:ARG:33
	LOCAL -= TALENT:ARG:21 + TALENT:ARG:22 + TALENT:ARG:24 + TALENT:ARG:27 + TALENT:ARG:30
	LOCAL += TALENT:ARG:91 + TALENT:ARG:92 + TALENT:ARG:113
	LOCAL += TALENT:ARG:83 + TALENT:ARG:87 + TALENT:ARG:88
	SIF TALENT:ARG:110
		LOCAL ++
	SIF TALENT:ARG:114
		LOCAL += 2
	IF TALENT:ARG:100
		SIF TALENT:ARG:10
			LOCAL ++
		SIF TALENT:ARG:109
			LOCAL ++
		SIF TALENT:ARG:116
			LOCAL += 2
	ENDIF
	SIF TALENT:ARG:99 && TALENT:ARG:248
			LOCAL ++
	IF ARGS:1 == "TOWN"
		;特殊な容姿,人間相手ではマイナス,魔族相手ではプラスの効果
		LOCAL -= TALENT:ARG:244 + TALENT:ARG:245 + TALENT:ARG:246 + TALENT:ARG:247 + TALENT:ARG:259 + TALENT:ARG:260
		;所持金補正
		SELECTCASE CFLAG:ARG:580 + CFLAG:581 + CFLAG:582
		CASE IS < -40000
			LOCAL += 5
		CASE IS < -20000
			LOCAL += 4
		CASE IS < -10000
			LOCAL += 3
		CASE IS < -5000
			LOCAL += 2
		CASE IS < 0
			LOCAL += 1
		CASE IS < 5000
			LOCAL -= 1
		CASE IS < 10000
			LOCAL -= 2
		CASEELSE
			LOCAL -= 3
		ENDSELECT
	ELSEIF ARGS:1 == "DUNGEON"
		LOCAL += TALENT:ARG:244 + TALENT:ARG:245 + TALENT:ARG:246 + TALENT:ARG:247 + TALENT:ARG:259 + TALENT:ARG:260
		;指示の有無
		IF CFLAG:ARG:500 == 1
			LOCAL *= 10 + ABL:ARG:10
			LOCAL /= 10
		ELSE
			SIF TALENT:ARG:85
				TIMES LOCAL, 0.5
		ENDIF
	ELSE
		THROW 不明な文字列%ARGS:1%
	ENDIF
	
	;肉便器補正
	SIF TALENT:ARG:204
		TIMES LOCAL, 1.5
		
	;0にはなる
	LOCAL = MAX(LOCAL, 0)
	RETURNF LOCAL
;プレイ内容ごとの可不可
CASE "ABLE"
	;先に共通条件
	;調教対象が空だとダメ
	SIF ARG < 0
		RETURNF 0
	;瀕死だとダメ
	SIF BASE:ARG:0 < 500
		RETURNF 0
		
	SELECTCASE ARGS:1
	;ひとりあそび
	CASE "SELF"
	;手コキコース
	CASE "HAND"
	;おフェラコース
	CASE "ORAL",
		;キス未経験なら嫌がる
		SIF CFLAG:ARG:16 == -1
			RETURNF 0
	;レズプレイ
	CASE "LES"
		;レズっ気2以上,C感覚3以上,欲望2以上,技巧2以上が必要
		SIF ABL:ARG:22 < 2 || ABL:ARG:0 < 3 || ABL:ARG:10 < 2 || ABL:ARG:11 < 2
			RETURNF 0
		;調教キャラにレズ中毒必要
		SIF ABL:ARG:33 == 0
			RETURNF 0
	;おしりコース
	CASE "ANAL"
	;本番コース
	CASE "SEX"
		;処女やオトコだとダメ
		SIF TALENT:ARG:0 || TALENT:ARG:122 == 1
			RETURNF 0
		;貞操帯だとダメ
		SIF CFLAG:ARG:42 == 79 && (CFLAG:ARG:40 & 64)
			RETURNF 0
		;貞操封印だとダメ
		SIF TALENT:ARG:273
			RETURNF 0
	;どうぶつコース
	;貞操封印ぬけてたっぽいので追加
	CASE "ANIMAL"
		;ITEM:野良犬がないとダメ
		;魔王様の犬とは違う犬だけど
		;性癖フィルター用に
		SIF ITEM:22 == 0
			RETURNF 0
		;処女やオトコだとダメ
		SIF TALENT:ARG:0 || TALENT:ARG:122 == 1
			RETURNF 0
		;貞操帯だとダメ
		SIF CFLAG:ARG:42 == 79 && (CFLAG:ARG:40 & 64)
			RETURNF 0
		;貞操封印だとダメ
		SIF TALENT:ARG:273
			RETURNF 0
	ENDSELECT
	RETURNF 1
;ヤった回数
CASE "PLAY"
	;SELFに限っては売春行為ではないため先に別個に処理する
	IF ARGS:1 == "SELF"
		LOCAL = ABL:ARG:31 + RAND:(ABL:ARG:11 + 1)
		LOCAL /= 3
		LOCAL += TALENT:ARG:60 + TALENT:ARG:74 + TALENT:ARG:272
		;自慰狂い
		SIF TALENT:ARG:74
			TIMES LOCAL, 1.5
		;オトコ-ふたなり-肉芽
		SIF TALENT:ARG:121 || TALENT:ARG:122 || TALENT:ARG:326
			TIMES LOCAL, 1.2
		;0にはならない
		LOCAL = MAX(LOCAL, 1)
		RETURNF LOCAL
	ENDIF
	LOCAL = 1 + RAND:3
	LOCAL += TALENT:ARG:63 + TALENT:ARG:64
	LOCAL += (TALENT:ARG:76 + TALENT:ARG:272) * 2
	LOCAL += (ABL:ARG:16 + ABL:ARG:37) / 3
	;場所:娼館街
	SIF FLAG:(CFLAG:ARG:501 + 349) == 507
		TIMES LOCAL, 1.2
	SELECTCASE ARGS:1
	;手コキコース
	CASE "HAND"
		LOCAL += ABL:ARG:32 / 3
	;おフェラコース
	CASE "ORAL"
		LOCAL += ABL:ARG:32 / 2
		SIF EXP:ARG:22
			LOCAL ++
		SIF TALENT:ARG:52
			LOCAL ++
		;精愛味覚
		SIF TALENT:ARG:47
			TIMES LOCAL, 1.5
	;びあんコース
	CASE "LES"
		LOCAL += (ABL:ARG:0 + ABL:ARG:22) / 3
		LOCAL += TALENT:ARG:81 + TALENT:ARG:82
		LOCAL *= (10 + ABL:ARG:33)
		LOCAL /= 10
	;おしりコース
	CASE "ANAL"
		LOCAL += (ABL:ARG:3 + ABL:ARG:30) / 3
		;尻穴狂い
		SIF TALENT:ARG:77
			TIMES LOCAL, 1.5
	;本番コース
	CASE "SEX"
		LOCAL += (ABL:ARG:2 + ABL:ARG:30) / 3
		;セックス狂
		SIF TALENT:ARG:75
			TIMES LOCAL, 1.5
	;どうぶつコース
	CASE "ANIMAL"
		LOCAL += (ABL:ARG:30 + ABL:ARG:39) / 3
		;動物耳とかわいい動物が好き
		LOCAL += TALENT:ARG:124 + (TALENT:ARG:317 == 12)
		;牝犬
		SIF TALENT:ARG:136
			TIMES LOCAL, 1.5
	ENDSELECT
	
	SIF !EXP:ARG:74
		LOCAL -= 5
		
	;0にはならない
	LOCAL = MAX(LOCAL, 1)
	RETURNF LOCAL
;抽選確率の設定用
CASE "KAKURITU"
	LOCAL = 1 + RAND:3
	SELECTCASE ARGS:1
	;手コキコース
	CASE "HAND"
		LOCAL += ABL:ARG:32 + 4
		;愛かつ娼婦でも傾城でもない
		SIF TALENT:ARG:85 && !(TALENT:ARG:180 || TALENT:ARG:181)
			TIMES LOCAL, 1.5
	;おフェラコース
	CASE "ORAL"
		LOCAL += ABL:ARG:32 + 3
		SIF TALENT:ARG:52
			LOCAL += 3
		;精愛味覚
		SIF TALENT:ARG:47
			TIMES LOCAL, 2.0
	;びあんコース
	CASE "LES"
		LOCAL += ABL:ARG:0 + ABL:ARG:22
		LOCAL *= (10 + ABL:ARG:33)
		LOCAL /= 10
	;おしりコース
	CASE "ANAL"
		LOCAL += ABL:ARG:3 + ABL:ARG:30
		;尻穴狂い
		SIF TALENT:ARG:77
			TIMES LOCAL, 2.0
	;本番コース
	CASE "SEX"
		LOCAL += ABL:ARG:2 + ABL:ARG:30
		;セックス狂
		SIF TALENT:ARG:75
			TIMES LOCAL, 2.0
	;どうぶつコース
	CASE "ANIMAL"
		LOCAL += ABL:ARG:30 + ABL:ARG:39
		;牝犬
		SIF TALENT:ARG:136
			TIMES LOCAL, 2.0
	ENDSELECT
	;0にはならない
	LOCAL = MAX(LOCAL, 1)
	LOCAL *= 5
	RETURNF LOCAL
;レート
;街中売春で使用,数字が大きいほど抵抗感が大きい(料金と抽選確率に影響)
CASE "RATE"
	SELECTCASE ARGS:1
	;基本料金はカルマ依存
	;すなわち尻軽ほど安い
	CASE "KARMA"
		RETURNF (250 + CFLAG:ARG:151)
	;手コキコース
	CASE "HAND"
		RETURNF 1
	;おフェラコース＆レズプレイ
	CASE "ORAL", "LES"
		RETURNF 2
	;おしりコース
	CASE "ANAL"
		RETURNF 3
	;本番コース
	CASE "SEX"
		RETURNF 4
	;どうぶつコース
	CASE "ANIMAL"
		RETURNF 11
	ENDSELECT
ENDSELECT

;-----------------------------------------------
@SHOW_BUTTON_BICH_LEVEL(NUM, ARG)
#DIM NUM
;-----------------------------------------------
;キャラの能力表示において[売春積極性]ボタンを表示する
;引数NUMはボタンの数値,ARGは対象キャラの番号


PRINTFORM [{NUM}] Prostitution Assertiveness - 

IF CFLAG:ARG:120 == 0
	PRINT None
ELSEIF CFLAG:ARG:120 == 1
	PRINT Normal
ELSE
	PRINTFORM Level {CFLAG:ARG:120}
ENDIF

PRINT  

RETURN 0

;-----------------------------------------------
@SET_BICH_LEVEL(ARG)
;-----------------------------------------------

PRINTL レベルを設定してください
PRINTL [0] [1] [2] [3] [4] [5]
INPUT

IF RESULT < 0
	RETURN 0
ELSEIF RESULT > 5
	RETURN 0
ENDIF

CFLAG:ARG:120 = RESULT

IF RESULT == 0
	PRINTW 売春積極性を皆無に変更しました
ELSEIF RESULT == 1
	PRINTW 売春積極性を普通に変更しました
ELSE
	PRINTFORMW 売春積極性を{RESULT}レベルに変更しました
ENDIF

RETURN 0


;旧構文
[SKIPSTART]
;ダンジョン内でのイベント奴隷用
;--------------------------------------
@DUNGEON_BITCH
;--------------------------------------
TARGET = A
SIF BASE:0 < 300
	RETURN 0
SIF BASE:1 < 100
	RETURN 0

IF CFLAG:500 != 1
	;売春以外
ELSEIF CFLAG:42 == 79 && (CFLAG:40 & 64) && FLAG:37
	;貞操帯
	CALL DUNGEON_ANAL
ELSEIF TALENT:273
	;貞操封印
	CALL DUNGEON_ANAL
ELSEIF ABL:TARGET:2 >= ABL:TARGET:3
	;V感覚>=A感覚
	CALL DUNGEON_SEX
ELSEIF ABL:TARGET:3 > 3
	;A感覚3超
	CALL DUNGEON_ANAL
ENDIF

N = 0
IF CFLAG:500 == 1 && ABL:TARGET:33 >= 1
	CALL DUNGEON_LES
	N = RESULT
ENDIF

SIF ABL:TARGET:31 >= 1
	CALL DUNGEON_SELF


SIF ABL:TARGET:39 >= 1
	CALL DUNGEON_ANIMAL
A = TARGET

;ついでに内職
SIF CFLAG:A:500 == 0 && CFLAG:A:1 == 3
	CALL DUNGEON_WORK

RETURN 0

;ダンジョン外で勇者が売春する用
;--------------------------------------
@HEROINE_BITCH
;--------------------------------------
;TARGET = A
;体力の判定
SIF BASE:0 < 300
	RETURN 0
SIF BASE:1 < 100
	RETURN 0

;まさかの時の獣姦ショー
CALL HEROINE_ANIMAL_SHOW
SIF RESULT == 1
	RETURN 0

IF RAND:3 == 0
	;やりやすいオーラル売春
	CALL HEROINE_BICH_ORAL	
ELSEIF TALENT:0 || TALENT:273
	;処女-貞操封印
	CALL HEROINE_BICH_ANAL
ELSEIF CFLAG:42 == 79 && (CFLAG:40 & 64)
	;貞操帯
	CALL HEROINE_BICH_ANAL
ELSEIF ABL:TARGET:2 >= ABL:TARGET:3
	CALL HEROINE_BICH_SEX
ELSEIF ABL:TARGET:3 > 3
	CALL HEROINE_BICH_ANAL
ELSEIF RAND:3 == 0
	CALL HEROINE_BICH_SEX
ELSEIF RAND:2 == 0
	CALL HEROINE_BICH_ANAL
ELSE
	CALL HEROINE_BICH_ORAL
ENDIF

RETURN 0


;-------------------------------
@DUNGEON_SEX
#DIM PLAY
#DIM PAY
#DIM MEN
;-------------------------------
;ダンジョン売春

;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0
;処女やオトコだとダメ
SIF TALENT:0 || TALENT:122 == 1
	RETURN 0
;貞操帯だとダメ
SIF CFLAG:42 == 79 && (CFLAG:40 & 64)
	RETURN 0
;貞操封印だとダメ
SIF TALENT:273
	RETURN 0
;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0

;性交回数
PLAY = 0
;代金
PAY = 0
;客
MEN = RAND:5

;娼婦のドレスボーナス
SIF (CFLAG:40 & 28) && CFLAG:41 == 203
	PLAY += 1

;V感覚
IF ABL:2 == 4
	PLAY += 1
ELSEIF ABL:2 == 5
	PLAY += 2
ELSEIF ABL:2 >= 6
	PLAY += 3
ENDIF

;性交中毒によるボーナス
SIF ABL:30
	PLAY += ABL:30 / 2 + 1

;回数が0以下なら終了
;SIF PLAY <= 0
;	RETURN 0

;欲望ＬV5以上奉仕精神5以上で+1
SIF ABL:11 >= 5 && ABL:16 >= 5
	PLAY += 2
;欲望ＬV４以上奉仕精神４以上で+1
SIF ABL:11 == 4 && ABL:16 >= 4
	PLAY += 1

;欲望ＬV７以上V感覚ＬV６以上で+1(下と合わせて+2)
SIF ABL:11 >= 7 && ABL:5 >= 6
	PLAY += 1
;欲望ＬV４以上V感覚ＬV３以上で+1
SIF ABL:11 >= 4 && ABL:2 >= 3
	PLAY += 1

;愛,淫乱によるボーナス
SIF TALENT:85
	PLAY += 1
SIF TALENT:76
	PLAY += 1

;セックス狂によるボーナス
SIF TALENT:75
	PLAY += 2

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;貞操無頓着,貞操観念
IF TALENT:31
	PLAY += 1
ELSEIF TALENT:30
	PLAY -= 2
ENDIF

;売春中毒によるボーナス
SIF ABL:37 > 0
	PLAY += ABL:37

;娼婦によるボーナス
SIF TALENT:180
	PLAY += 1

;傾城によるボーナス
SIF TALENT:181
	PLAY += 2

;肉便器によるボーナス
SIF TALENT:204
	PLAY += 1

IF TALENT:315 == 5
	;元娼婦の場合ボーナス
	PLAY += 2
ELSEIF TALENT:315 == 7
	;元物乞いの場合ボーナス
	PLAY += 1
ELSEIF TALENT:315 == 2
	;元修道女
	PLAY -= 1
ELSEIF TALENT:315 == 8
	;元貴族
	PLAY -= 1
ELSEIF TALENT:315 == 12
	;元聖女
	PLAY -= 1
ENDIF

;カルマによる積極性
IF CFLAG:151 > 150
	PLAY -= 3
ELSEIF CFLAG:151 > 100
	PLAY -= 2
ELSEIF CFLAG:151 > 50
	PLAY -= 1
ELSEIF CFLAG:151 > 0
	;変動なし
ELSEIF CFLAG:151 > -50
	PLAY += 1
ELSEIF CFLAG:151 > -100
	PLAY += 2
ELSEIF CFLAG:151 > -150
	PLAY += 3
ELSE
	PLAY += 4
ENDIF

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

DRAWLINE
PRINTFORM %SAVESTR:TARGET%は
;売春中毒か淫乱
IF ABL:TARGET:37 == 1 || TALENT:TARGET:76 == 1
	PRINTFORM 性欲を抑えきれず
ELSE
	PRINTFORM 命令に従って
ENDIF
IF MEN == 0
	PRINT オ-ク
ELSEIF MEN == 1
	PRINT 魔族の男
ELSEIF MEN == 2
	PRINT 魔族の少年
	;収入減
	PAY -= 10
ELSEIF MEN == 3
	PRINT 魔族の成金
	;収入ボーナス
	PAY += 20
ELSE
	PRINT コボルトの商人
ENDIF
PRINTFORML を呼び寄せて売春した
PRINTFORMW {PLAY}回冷たい床の上でまぐわったようだ...

CALL DUNGEON_SEX_LOG, MEN

PRINTFORML %EXPNAME:0%+{PLAY}
PRINTFORML %EXPNAME:5%+{PLAY}
PRINTFORML %EXPNAME:74%+{PLAY}
PRINTFORML %PALAMNAME:1%の珠+{PLAY*200}
PRINTFORMW %PALAMNAME:5%の珠+{PLAY*250}
EXP:0 += PLAY
EXP:5 += PLAY
EXP:74 += PLAY
JUEL:1 += PLAY*200
JUEL:5 += PLAY*250
PRINTFORML %SAVESTR:TARGET%の逸脱は魔王と奴隷の力となった(経験値+{PLAY})
EXP:0:80 += PLAY
EXP:TARGET:80 += PLAY
PAY += PLAY * 10
SIF PAY <= 0
	PAY = 1
PRINTFORMW %SAVESTR:TARGET%は代金を{PAY}入手した
MONEY += PAY
PRINTW (カルマが減少しました:-1)
CALL KARMA, TARGET, -1
RETURN 1

;--------------------------------
@DUNGEON_ANAL
#DIM PLAY
#DIM PAY
#DIM MEN
;--------------------------------
;ダンジョンアナル
;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0
;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0

;性交回数
PLAY = 0
;代金
PAY = 0
;客
MEN = RAND:5

;娼婦のドレスボーナス
SIF (CFLAG:40 & 28) && CFLAG:41 == 203
	PLAY += 1

;A感覚
IF ABL:3 == 4
	PLAY += 1
ELSEIF ABL:3 == 5
	PLAY += 2
ELSEIF ABL:3 >= 6
	PLAY += 3
ENDIF

;性交中毒によるボーナス
SIF ABL:30
	PLAY += ABL:30 / 2 + 1

;回数が0以下なら終了
;SIF PLAY <= 0
;	RETURN 0

;欲望ＬV5以上奉仕精神5以上で+1
SIF ABL:11 >= 5 && ABL:16 >= 5
	PLAY += 2
;欲望ＬV４以上奉仕精神４以上で+1
SIF ABL:11 == 4 && ABL:16 >= 4
	PLAY += 1

;欲望ＬV７以上V感覚ＬV６以上で+1(下と合わせて+2)
SIF ABL:11 >= 7 && ABL:5 >= 6
	PLAY += 1
;欲望ＬV４以上V感覚ＬV３以上で+1
SIF ABL:11 >= 4 && ABL:2 >= 3
	PLAY += 1

;愛,淫乱によるボーナス
SIF TALENT:85
	PLAY += 1
SIF TALENT:76
	PLAY += 1

;尻穴狂いによるボーナス
SIF TALENT:75
	PLAY += 2

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;貞操無頓着,貞操観念
IF TALENT:31
	PLAY += 1
ELSEIF TALENT:30
	PLAY -= 2
ENDIF

;売春中毒によるボーナス
SIF ABL:37 > 0
	PLAY += ABL:37

;娼婦によるボーナス
SIF TALENT:180
	PLAY += 1

;傾城によるボーナス
SIF TALENT:181
	PLAY += 2

;肉便器によるボーナス
SIF TALENT:204
	PLAY += 1

IF TALENT:315 == 5
	;元娼婦の場合ボーナス
	PLAY += 2
ELSEIF TALENT:315 == 7
	;元物乞いの場合ボーナス
	PLAY += 1
ENDIF

;カルマによる積極性
IF CFLAG:151 > 150
	PLAY -= 3
ELSEIF CFLAG:151 > 100
	PLAY -= 2
ELSEIF CFLAG:151 > 50
	PLAY -= 1
ELSEIF CFLAG:151 > 0
	;変動なし
ELSEIF CFLAG:151 > -50
	PLAY += 1
ELSEIF CFLAG:151 > -100
	PLAY += 2
ELSEIF CFLAG:151 > -150
	PLAY += 3
ELSE
	PLAY += 4
ENDIF

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

DRAWLINE
PRINTFORM %SAVESTR:TARGET%は
;売春中毒か淫乱
IF ABL:TARGET:37 == 1 || TALENT:TARGET:76 == 1
	PRINTFORM 性欲を抑えきれず
ELSE
	PRINTFORM 命令に従って
ENDIF
IF MEN == 0
	PRINT オ-ク
ELSEIF MEN == 1
	PRINT 魔族の男
ELSEIF MEN == 2
	PRINT 魔族の少年
	;収入減
	PAY -= 10
ELSEIF MEN == 3
	PRINT 魔族の成金
	;収入ボーナス
	PAY += 20
ELSE
	PRINT コボルトの商人
ENDIF
PRINTFORML を呼び寄せて尻穴を売った
PRINTFORMW {PLAY}回冷たい床の上でまぐわったようだ...

CALL DUNGEON_ANAL_LOG, MEN

PRINTFORML %EXPNAME:1%+{PLAY}
PRINTFORML %EXPNAME:5%+{PLAY}
PRINTFORML %EXPNAME:74%+{PLAY}
PRINTFORML %PALAMNAME:2%の珠+{PLAY*200}
PRINTFORMW %PALAMNAME:5%の珠+{PLAY*250}
EXP:1 += PLAY
EXP:5 += PLAY
EXP:74 += PLAY
JUEL:2 += PLAY*200
JUEL:5 += PLAY*250

PRINTFORML %SAVESTR:TARGET%の逸脱は魔王と奴隷の力となった(経験値+{PLAY})
EXP:0:80 += PLAY
EXP:TARGET:80 += PLAY

PAY += PLAY * 10
SIF PAY <= 0
	PAY = 1
PRINTFORMW %SAVESTR:TARGET%は代金を{PAY}入手した
MONEY += PAY

PRINTW (カルマが減少しました:-2)
CALL KARMA, TARGET, -2

RETURN 1




;--------------------------------
@DUNGEON_LES
#DIM PLAY
#DIM PAY
#DIM GIRL
;--------------------------------
;ダンジョンレズ
;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0
;レズっ気2以上,C感覚3以上,欲望2以上,技巧2以上が必要
SIF ABL:22 < 2 || ABL:0 < 3 || ABL:10 < 2 || ABL:11 < 2
	RETURN 0
;調教キャラにレズ中毒必要
SIF ABL:33 == 0
	RETURN 0
;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0

;レズプレイ回数
PLAY = 0
;代金
PAY = 0
;客
GIRL = RAND:5

;娼婦のドレスボーナス
SIF (CFLAG:40 & 28) && CFLAG:41 == 203
	PLAY += 1


;レズ中毒
IF ABL:33 == 1
	PLAY += 1
ELSEIF ABL:33 == 2
	PLAY += 2
ELSEIF ABL:33 == 3
	PLAY += 3
ELSEIF ABL:33 == 4
	PLAY += 5
ELSEIF ABL:33 == 5
	PLAY += 7
ELSEIF ABL:33 >= 6
	PLAY += 9
ENDIF


;回数が0以下なら終了
SIF PLAY <= 0
	RETURN 0

;レズっ気によるボーナス
SIF ABL:22 >= 5
	PLAY += 1

;欲望ＬV７以上で+1(下と合わせて+2)
SIF ABL:11 >= 7 && ABL:5 >= 6
	PLAY += 1
;欲望ＬV４以上で+1
SIF ABL:11 >= 4 && ABL:2 >= 3
	PLAY += 1


;保守的,一線越えないによるペナルティ
SIF TALENT:24
	PLAY -= 1
SIF TALENT:27
	PLAY -= 1


;両刀,淫乱によるボーナス
SIF TALENT:81
	PLAY += 2
SIF TALENT:76
	PLAY += 1

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;売春中毒によるボーナス
SIF ABL:37 > 0
	PLAY += ABL:37

;娼婦によるボーナス
SIF TALENT:180
	PLAY += 1

;傾城によるボーナス
SIF TALENT:181
	PLAY += 2

;肉便器によるボーナス
SIF TALENT:204
	PLAY += 1

IF TALENT:315 == 5
	;元娼婦の場合ボーナス
	PLAY += 2
ELSEIF TALENT:315 == 7
	;元物乞いの場合ボーナス
	PLAY += 1
ENDIF

;カルマによる積極性
IF CFLAG:151 > 150
	PLAY -= 3
ELSEIF CFLAG:151 > 100
	PLAY -= 2
ELSEIF CFLAG:151 > 50
	PLAY -= 1
ELSEIF CFLAG:151 > 0
	;変動なし
ELSEIF CFLAG:151 > -50
	PLAY += 1
ELSEIF CFLAG:151 > -100
	PLAY += 2
ELSEIF CFLAG:151 > -150
	PLAY += 3
ELSE
	PLAY += 4
ENDIF

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

PRINTFORMW %SAVESTR:TARGET%は
;売春中毒か淫乱
IF ABL:TARGET:37 == 1 || TALENT:TARGET:76 == 1
	PRINTFORM 女に飢えて
ELSE
	PRINTFORM 命令に従って
ENDIF

IF GIRL == 0
	PRINT 淫魔
ELSEIF GIRL == 1
	PRINT 魔族の女
ELSEIF GIRL == 2
	PRINT エルフの女乞食
	;収入減
	PAY -= 10
ELSEIF GIRL == 3
	PRINT 魔族の貴婦人
	;収入ボーナス
	PAY += 20
ELSE
	PRINT 魔族の女司祭
ENDIF

PRINTFORML を呼び止め
PRINTFORMW {PLAY}回レズプレイをしたようだ.

CALL DUNGEON_LES_LOG, GIRL

PRINTFORML %EXPNAME:40%+{PLAY}
SIF N*100*ABL:10/500 > 0
	PRINTFORML %EXPNAME:2%+{PLAY*100*ABL:10/500}
PRINTFORML %EXPNAME:74%+{PLAY}
PRINTFORML %PALAMNAME:0%の珠+{PLAY*100*ABL:10}
PRINTFORML %PALAMNAME:5%の珠+{PLAY*200}

EXP:40 += PLAY
EXP:2 += PLAY*100*ABL:10/500
EXP:74 += PLAY
JUEL:0 += PLAY*100*ABL:10
JUEL:5 += PLAY*200

PRINTFORML %SAVESTR:TARGET%の逸脱は魔王と奴隷の力となった(経験値+{PLAY})
EXP:0:80 += PLAY
EXP:TARGET:80 += PLAY

PAY += PLAY * 10
SIF PAY <= 0
	PAY = 1
PRINTFORMW %SAVESTR:TARGET%は代金を{PAY}入手した
MONEY += PAY

RETURN 1

;-------------------------------------
@DUNGEON_SELF
#DIM PLAY
;-------------------------------------
;ダンジョンでの自慰
;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0
;Ｃ感覚が3以上,欲望が2以上ないとダメ
SIF ABL:0 < 3 || ABL:11 < 2
	RETURN 0
;自慰しないがあるとダメ
SIF TALENT:150
	RETURN 0
;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0

PLAY = 0

;自慰中毒
IF ABL:31 == 1
	PLAY += 1
ELSEIF ABL:31 == 2
	PLAY += 2
ELSEIF ABL:31 == 3
	PLAY += 4
ELSEIF ABL:31 == 4
	PLAY += 6
ELSEIF ABL:31 == 5
	PLAY += 9
ELSEIF ABL:31 >= 6
	PLAY += 14
ENDIF

;自慰しやすいで欲望ＬV３以上
SIF TALENT:60 && ABL:11 >= 3
	PLAY += 1

;欲望ＬV5以上露出癖４以上で+1(下と合わせて+2)
SIF ABL:11 >= 5 && ABL:17 >= 4
	PLAY += 1
;欲望ＬV４以上露出癖３以上で+1(下と合わせて+2)
SIF ABL:11 >= 4 && ABL:17 >= 3
	PLAY += 1

;回数が0以下なら終了
SIF PLAY <= 0
	RETURN 0

;自慰狂いによるボーナス
SIF TALENT:74
	TIMES PLAY , 1.50

;プライド低い,解放によるボーナス
SIF TALENT:17
	PLAY += 1
SIF TALENT:33
	PLAY += 1

;プライド高い,自制心,抑圧によるペナルティ
SIF TALENT:15
	PLAY -= 1
SIF TALENT:20
	PLAY -= 1
SIF TALENT:32
	PLAY -= 1

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;淫乱によるボーナス
SIF TALENT:76
	PLAY += 1

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

DRAWLINE


;調教後オナニーの妄想の相手
;愛がなくかつレズっ気×20%でレズ
IF TALENT:85 == 0 && ABL:22 > RAND:5
	PRINTFORML レズセックスを妄想しながら{PLAY}回自慰をしたようだ.
;上に該当せずかつ愛がなくアイテムに野良犬があれば,獣姦中毒×20%で野良犬
ELSEIF TALENT:85 == 0 && ABL:39 > RAND:5 && ITEM:22
	PRINTFORML 野獣との交尾を妄想しながら{PLAY}回自慰をしたようだ.
;それ以外なら主人
ELSE
	PRINTFORML %CALLNAME:MASTER%の事を想いながら{PLAY}回自慰をしたようだ.
ENDIF


;自慰経験
PRINTFORML %EXPNAME:10%+{PLAY}
EXP:10 += PLAY

;珠経験
PRINTFORML %PALAMNAME:0%の珠+{PLAY*500}
PRINTFORML %PALAMNAME:4%の珠+{PLAY*100}
PRINTFORMW %PALAMNAME:5%の珠+{PLAY*250}
JUEL:0 += PLAY*500
JUEL:4 += PLAY*100
JUEL:5 += PLAY*250

	
PRINTFORMW %SAVESTR:TARGET%の逸脱は魔王と奴隷の力となった(経験値+{PLAY})
EXP:0:80 += PLAY
EXP:TARGET:80 += PLAY

RETURN 1


;--------------------------------
@DUNGEON_ANIMAL
#DIM PLAY
;--------------------------------
;ダンジョン獣姦

;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0

;獣姦経験が50以上ないとダメ
SIF EXP:56 < 50
	RETURN 0

;処女やオトコだとダメ
SIF TALENT:0 || TALENT:122 == 1
	RETURN 0

;貞操帯だとダメ
SIF CFLAG:42 == 79 && (CFLAG:40 & 64)
	RETURN 0

;ITEM:野良犬がないとダメ
SIF ITEM:22 == 0
	RETURN 0
;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0

PLAY = 0

;獣姦中毒
IF ABL:39 == 0
	PLAY -= 2
ELSEIF ABL:39 == 1
	PLAY -= 1
ELSEIF ABL:39 == 2
	PLAY += 0
ELSEIF ABL:39 == 3
	PLAY += 1
ELSEIF ABL:39 == 4
	PLAY += 2
ELSEIF ABL:39 == 5
	PLAY += 3
ELSEIF ABL:39 >= 6
	PLAY += 4
ENDIF

;動物耳で欲望ＬV３以上
SIF TALENT:124 && ABL:11 >= 3
	PLAY += 1

;かわいい動物が好きで欲望ＬV４以上
SIF  TALENT:317 == 12 && ABL:11 >= 4
	PLAY += 1

;欲望ＬV5以上露出癖４以上で+1(下と合わせて+2)
SIF ABL:11 >= 5 && ABL:17 >= 4
	PLAY += 1
;欲望ＬV４以上露出癖３以上で+1
SIF ABL:11 >= 4 && ABL:17 >= 3
	PLAY += 1

;牝犬によるボーナス
SIF TALENT:136
	PLAY += 2

;回数が0以下なら終了
SIF PLAY <= 0
	RETURN 0

;プライド低い,解放,動物耳によるボーナス
SIF TALENT:17
	PLAY += 1
SIF TALENT:33
	PLAY += 1
SIF TALENT:124
	PLAY += 1

;プライド高い,自制心,抑圧,汚臭敏感によるペナルティ
SIF TALENT:15
	PLAY -= 1
SIF TALENT:20
	PLAY -= 1
SIF TALENT:32
	PLAY -= 1
SIF TALENT:62 && TALENT:64 == 0
	PLAY -= 2

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;淫乱によるボーナス
SIF TALENT:76
	PLAY += 1

;牝犬によるボーナスその2
SIF TALENT:136
	TIMES PLAY , 1.50

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

DRAWLINE
PRINTFORM %SAVESTR:TARGET%は獣姦への欲望を抑えきれず
PRINTFORML 野獣のモンスタ-と{PLAY}回の交尾を行ったらしい.

;獣姦経験
PRINTFORML %EXPNAME:56%+{PLAY}
PRINTFORML %EXPNAME:0%+{PLAY}
PRINTFORML %EXPNAME:5%+{PLAY}
EXP:56 += PLAY
EXP:0 += PLAY
EXP:5 += PLAY

;珠経験
PRINTFORML %PALAMNAME:1%の珠+{PLAY*200}
PRINTFORML %PALAMNAME:6%の珠+{PLAY*300}
PRINTFORMW %PALAMNAME:8%の珠+{PLAY*200}
JUEL:1 += PLAY*200
JUEL:6 += PLAY*300
JUEL:8 += PLAY*200

PRINTFORMW %SAVESTR:TARGET%の逸脱は魔王と奴隷の力となった(経験値+{PLAY})
EXP:0:80 += PLAY
EXP:TARGET:80 += PLAY

PRINTW (カルマが減少しました:-2)
CALL KARMA, TARGET, -2

RETURN 1

;--------------------------------------
@DUNGEON_WORK
;--------------------------------------
;内職

M = (CFLAG:A:9 * 20) + 100

IF FLAG:5 & 32
	PRINTFORM %SAVESTR:A%は
	IF RAND:4 == 0
		PRINT 宝石磨き
	ELSEIF RAND:3 == 0
		PRINT 細工物
	ELSEIF RAND:2 == 0
		PRINT 写本
	ELSE
		PRINT 手芸
	ENDIF
	PRINTFORMW の内職で{M}の収入を得た
ENDIF

MONEY += M

RETURN 0

;-------------------------------
@HEROINE_BICH_SEX
#DIM PLAY
#DIM PAY
#DIM MEN
;-------------------------------
;ダンジョン外の勇者売春

;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0
;処女やオトコだとダメ
SIF TALENT:0 || TALENT:122 == 1
	RETURN 0
;貞操帯だとダメ
SIF CFLAG:42 == 79 && (CFLAG:40 & 64)
	RETURN 0
;貞操封印だとダメ
SIF TALENT:273
	RETURN 0
;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0
;未経験の場合カルマがある程度まで低くないとダメ
;回数補正に変更
;SIF CFLAG:151 > 50 && EXP:74 == 0
;	RETURN 0

;性交回数
;初期値は低い
PLAY = -2
;代金
PAY = 0
;客
MEN = RAND:5

;未経験の場合ペナルティ
SIF EXP:74 == 0
	PLAY -= 3

;娼婦のドレスボーナス
SIF (CFLAG:40 & 28) && CFLAG:41 == 203
	PLAY += 1

;V感覚
IF ABL:2 == 4
	PLAY += 1
ELSEIF ABL:2 == 5
	PLAY += 2
ELSEIF ABL:2 >= 6
	PLAY += 3
ENDIF

;性交中毒によるボーナス
SIF ABL:30
	PLAY += ABL:30 / 2 + 1

;回数が0以下なら終了
;SIF PLAY <= 0
;	RETURN 0

;欲望ＬV5以上奉仕精神5以上で+1
SIF ABL:11 >= 5 && ABL:16 >= 5
	PLAY += 2
;欲望ＬV４以上奉仕精神４以上で+1
SIF ABL:11 == 4 && ABL:16 >= 4
	PLAY += 1

;欲望ＬV７以上V感覚ＬV６以上で+1(下と合わせて+2)
SIF ABL:11 >= 7 && ABL:5 >= 6
	PLAY += 1
;欲望ＬV４以上V感覚ＬV３以上で+1
SIF ABL:11 >= 4 && ABL:2 >= 3
	PLAY += 1

;愛,淫乱によるボーナス
SIF TALENT:85
	PLAY += 1
SIF TALENT:76
	PLAY += 1

;セックス狂によるボーナス
SIF TALENT:75
	PLAY += 2

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;貞操無頓着,貞操観念
IF TALENT:31
	PLAY += 1
ELSEIF TALENT:30
	PLAY -= 2
ENDIF

;売春中毒によるボーナス
SIF ABL:37 > 0
	PLAY += ABL:37

;娼婦によるボーナス
SIF TALENT:180
	PLAY += 1

;傾城によるボーナス
SIF TALENT:181
	PLAY += 2

;肉便器によるボーナス
SIF TALENT:204
	PLAY += 1

;ショタコンの場合,客が少年になる
IF TALENT:ショタコン
	MEN = 2
	PLAY += 1
ENDIF

IF TALENT:315 == 5
	;元娼婦の場合ボーナス
	PLAY += 3
ELSEIF TALENT:315 == 7
	;元物乞いの場合ボーナス
	PLAY += 2
ELSEIF TALENT:315 == 2
	;元修道女
	PLAY -= 1
ELSEIF TALENT:315 == 8
	;元貴族
	PLAY -= 1
ELSEIF TALENT:315 == 12
	;元聖女
	PLAY -= 1
ENDIF

;カルマによる積極性
IF CFLAG:151 > 150
	PLAY -= 3
ELSEIF CFLAG:151 > 100
	PLAY -= 2
ELSEIF CFLAG:151 > 50
	PLAY -= 1
ELSEIF CFLAG:151 > 0
	;変動なし
ELSEIF CFLAG:151 > -50
	PLAY += 1
ELSEIF CFLAG:151 > -100
	PLAY += 2
ELSEIF CFLAG:151 > -150
	PLAY += 3
ELSE
	PLAY += 4
ENDIF

;借金による強制
IF CFLAG:582 >= 0
	PLAY -= 3
ELSEIF CFLAG:582 > -1000
	PLAY -= 2
ELSEIF CFLAG:582 > -2000
	PLAY -= 1
ELSEIF CFLAG:582 > -3000
	;変動なし
ELSEIF CFLAG:582 > -4000
	PLAY += 1
ELSEIF CFLAG:582 > -6000
	PLAY += 2
ELSEIF CFLAG:582 > -8000
	PLAY += 3
ELSEIF CFLAG:582 > -11000
	PLAY += 4
ELSEIF CFLAG:582 > -15000
	PLAY += 5
ELSEIF CFLAG:582 > -20000
	PLAY += 6
ELSE
	PLAY += 7
ENDIF

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

DRAWLINE

IF TALENT:勇者になる前の生活 == 8
	;貴族
	PRINT 貴族の
ELSEIF TALENT:勇者になる前の生活 == 12
	;聖女
	PRINT 聖女の
ELSEIF TALENT:チャームポイント == 23
	;大きな尻
	PRINT 大きな尻の
ELSE
	;特に何もない場合髪色
	PRINTFORM %GET_LOOK_INFO(TARGET, "髪の色")%の
ENDIF

PRINTFORM %SAVESTR:TARGET%は
;売春中毒か淫乱
IF ABL:TARGET:37 == 1 || TALENT:TARGET:76 == 1
	PRINTFORM 性欲を抑えきれず
ELSEIF CFLAG:582 < -4000
	PRINTFORM 借金が膨らみ過ぎて
ELSE
	PRINTFORM 冒険資金が底をついて
ENDIF
IF MEN == 0
	PRINT 村の男
ELSEIF MEN == 1
	PRINT 冒険者の男
ELSEIF MEN == 2
	PRINT 村の少年
	;収入減
	PAY -= 10
ELSEIF MEN == 3
	PRINT 街の成金
	;収入ボーナス
	PAY += 20
ELSE
	PRINT 行商人の男
ENDIF
PRINTFORML を呼び寄せて売春した
PRINTFORMW {PLAY}回裏通りの安宿で身体を売ったようだ...

PRINTFORML %EXPNAME:0%+{PLAY}
PRINTFORML %EXPNAME:5%+{PLAY}
PRINTFORML %EXPNAME:74%+{PLAY}
PRINTFORML %PALAMNAME:1%の珠+{PLAY*10}
PRINTFORMW %PALAMNAME:5%の珠+{PLAY*15}
EXP:0 += PLAY
EXP:5 += PLAY
EXP:74 += PLAY
JUEL:1 += PLAY*10
JUEL:5 += PLAY*15

PAY += PLAY * 100
SIF PAY <= 0
	PAY = 1
PRINTFORMW %SAVESTR:TARGET%は代金を{PAY}入手し,経験値を同量得た
EXP:80 += PAY
CFLAG:580 += PAY
PRINTW (カルマが減少しました:-1)
CALL KARMA, TARGET, -1
RETURN 1

;--------------------------------
@HEROINE_BICH_ANAL
#DIM PLAY
#DIM PAY
#DIM MEN
;--------------------------------
;ダンジョン外アナル売春
;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0
;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0
;未経験の場合カルマがある程度まで低くないとダメ
;SIF CFLAG:151 > 50 && EXP:74 == 0
;	RETURN 0

;性交回数
;初期値は低い
PLAY = -2
;代金
PAY = 0
;客
MEN = RAND:5

;未経験の場合ペナルティ
;アナルは一般性癖じゃないので若干抵抗が大きい
SIF EXP:74 == 0
	PLAY -= 4

;娼婦のドレスボーナス
SIF (CFLAG:40 & 28) && CFLAG:41 == 203
	PLAY += 1

;A感覚
IF ABL:3 == 4
	PLAY += 1
ELSEIF ABL:3 == 5
	PLAY += 2
ELSEIF ABL:3 >= 6
	PLAY += 3
ENDIF

;性交中毒によるボーナス
SIF ABL:30
	PLAY += ABL:30 / 2 + 1

;回数が0以下なら終了
;SIF PLAY <= 0
;	RETURN 0

;欲望ＬV5以上奉仕精神5以上で+1
SIF ABL:11 >= 5 && ABL:16 >= 5
	PLAY += 2
;欲望ＬV４以上奉仕精神４以上で+1
SIF ABL:11 == 4 && ABL:16 >= 4
	PLAY += 1

;欲望ＬV７以上V感覚ＬV６以上で+1(下と合わせて+2)
SIF ABL:11 >= 7 && ABL:5 >= 6
	PLAY += 1
;欲望ＬV４以上V感覚ＬV３以上で+1
SIF ABL:11 >= 4 && ABL:2 >= 3
	PLAY += 1

;愛,淫乱によるボーナス
SIF TALENT:85
	PLAY += 1
SIF TALENT:76
	PLAY += 1

;尻穴狂いによるボーナス
SIF TALENT:75
	PLAY += 2

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;貞操無頓着,貞操観念
IF TALENT:31
	PLAY += 1
ELSEIF TALENT:30
	PLAY -= 2
ENDIF

;売春中毒によるボーナス
SIF ABL:37 > 0
	PLAY += ABL:37

;娼婦によるボーナス
SIF TALENT:180
	PLAY += 1

;傾城によるボーナス
SIF TALENT:181
	PLAY += 2

;肉便器によるボーナス
SIF TALENT:204
	PLAY += 1

;ショタコンの場合,客が少年になる
IF TALENT:ショタコン
	MEN = 2
	PLAY += 1
ENDIF


IF TALENT:315 == 5
	;元娼婦の場合ボーナス
	PLAY += 3
ELSEIF TALENT:315 == 7
	;元物乞いの場合ボーナス
	PLAY += 2
ENDIF

;カルマによる積極性
IF CFLAG:151 > 150
	PLAY -= 3
ELSEIF CFLAG:151 > 100
	PLAY -= 2
ELSEIF CFLAG:151 > 50
	PLAY -= 1
ELSEIF CFLAG:151 > 0
	;変動なし
ELSEIF CFLAG:151 > -50
	PLAY += 1
ELSEIF CFLAG:151 > -100
	PLAY += 2
ELSEIF CFLAG:151 > -150
	PLAY += 3
ELSE
	PLAY += 4
ENDIF

;借金による強制
IF CFLAG:582 >= 0
	PLAY -= 3
ELSEIF CFLAG:582 > -1000
	PLAY -= 2
ELSEIF CFLAG:582 > -2000
	PLAY -= 1
ELSEIF CFLAG:582 > -3000
	;変動なし
ELSEIF CFLAG:582 > -4000
	PLAY += 1
ELSEIF CFLAG:582 > -6000
	PLAY += 2
ELSEIF CFLAG:582 > -8000
	PLAY += 3
ELSEIF CFLAG:582 > -11000
	PLAY += 4
ELSEIF CFLAG:582 > -15000
	PLAY += 5
ELSEIF CFLAG:582 > -20000
	PLAY += 6
ELSE
	PLAY += 7
ENDIF

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

DRAWLINE

IF TALENT:勇者になる前の生活 == 8
	;貴族
	PRINT 貴族の
ELSEIF TALENT:勇者になる前の生活 == 12
	;聖女
	PRINT 聖女の
ELSEIF TALENT:チャームポイント == 23
	;大きな尻
	PRINT 大きな尻の
ELSE
	;特に何もない場合髪色
	PRINTFORM %GET_LOOK_INFO(TARGET, "髪の色")%の
ENDIF

PRINTFORM %SAVESTR:TARGET%は
;売春中毒か淫乱
IF ABL:TARGET:37 == 1 || TALENT:TARGET:76 == 1
	PRINTFORM 性欲を抑えきれず
ELSEIF CFLAG:582 < -4000
	PRINTFORM 借金が膨らみ過ぎて
ELSE
	PRINTFORM 冒険資金が底をついて
ENDIF
IF MEN == 0
	PRINT 村の男
ELSEIF MEN == 1
	PRINT 冒険者の男
ELSEIF MEN == 2
	PRINT 村の少年
	;収入減
	PAY -= 10
ELSEIF MEN == 3
	PRINT 街の成金
	;収入ボーナス
	PAY += 20
ELSE
	PRINT 行商人の男
ENDIF
PRINTFORML を呼び寄せてアナル売春した
PRINTFORMW {PLAY}回裏通りの安宿で尻穴を売ったようだ...

PRINTFORML %EXPNAME:1%+{PLAY}
PRINTFORML %EXPNAME:5%+{PLAY}
PRINTFORML %EXPNAME:74%+{PLAY}
PRINTFORML %PALAMNAME:2%の珠+{PLAY*10}
PRINTFORMW %PALAMNAME:5%の珠+{PLAY*15}
EXP:1 += PLAY
EXP:5 += PLAY
EXP:74 += PLAY
JUEL:2 += PLAY*10
JUEL:5 += PLAY*15

PAY += PLAY * 100
SIF PAY <= 0
	PAY = 1
PRINTFORMW %SAVESTR:TARGET%は代金を{PAY}入手し,経験値を同量得た
EXP:80 += PAY
CFLAG:580 += PAY

PRINTW (カルマが減少しました:-2)
CALL KARMA, TARGET, -2

RETURN 1

;--------------------------------
@HEROINE_BICH_ORAL
#DIM PLAY
#DIM PAY
#DIM MEN
;--------------------------------
;ダンジョン外フェラ売春
;ハードルがだいぶ低い

;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0
;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0

;性交回数
;初期値は低い
PLAY = -2
;代金
PAY = 0
;客
MEN = RAND:5

;未経験の場合ペナルティ
;若干抵抗が少ない
SIF EXP:74 == 0
	PLAY -= 2

;娼婦のドレスボーナス
SIF (CFLAG:40 & 28) && CFLAG:41 == 203
	PLAY += 1

;奉仕技術
PLAY += ABL:奉仕技術

;奉仕精神によるボーナス
PLAY += ABL:奉仕精神

;精液中毒によるボーナス
PLAY += ABL:精液中毒

;欲望ＬV４以上で+1
SIF ABL:11 == 4
	PLAY += 1

;欲望ＬV5以上で+1
SIF ABL:11 >= 5
	PLAY += 1

;欲望ＬV７以上で+1
SIF ABL:11 >= 7
	PLAY += 1

;愛,淫乱によるボーナス
SIF TALENT:85
	PLAY += 1
SIF TALENT:76
	PLAY += 1

;精愛味覚によるボーナス
SIF TALENT:精愛味覚
	PLAY += 2

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;貞操無頓着,貞操観念
IF TALENT:31
	PLAY += 1
ELSEIF TALENT:30
	PLAY -= 2
ENDIF

;売春中毒によるボーナス
SIF ABL:37 > 0
	PLAY += ABL:37

;舌使いによるボーナス
SIF TALENT:舌使い
	PLAY += 1

;汚臭鈍感,汚臭敏感
IF TALENT:汚臭鈍感
	PLAY += 1
ELSEIF TALENT:汚臭敏感
	PLAY -= 2
ENDIF

;娼婦によるボーナス
SIF TALENT:180
	PLAY += 1

;傾城によるボーナス
SIF TALENT:181
	PLAY += 2

;肉便器によるボーナス
SIF TALENT:204
	PLAY += 1

;ショタコンの場合,客が少年になる
IF TALENT:ショタコン
	MEN = 2
	PLAY += 1
ENDIF


IF TALENT:315 == 5
	;元娼婦の場合ボーナス
	PLAY += 3
ELSEIF TALENT:315 == 7
	;元物乞いの場合ボーナス
	PLAY += 2
ENDIF

;カルマによる積極性
IF CFLAG:151 > 150
	PLAY -= 3
ELSEIF CFLAG:151 > 100
	PLAY -= 2
ELSEIF CFLAG:151 > 50
	PLAY -= 1
ELSEIF CFLAG:151 > 0
	;変動なし
ELSEIF CFLAG:151 > -50
	PLAY += 1
ELSEIF CFLAG:151 > -100
	PLAY += 2
ELSEIF CFLAG:151 > -150
	PLAY += 3
ELSE
	PLAY += 4
ENDIF

;借金による強制
IF CFLAG:582 >= 0
	PLAY -= 3
ELSEIF CFLAG:582 > -500
	PLAY -= 2
ELSEIF CFLAG:582 > -1500
	PLAY -= 1
ELSEIF CFLAG:582 > -2500
	;変動なし
ELSEIF CFLAG:582 > -3500
	PLAY += 1
ELSEIF CFLAG:582 > -4500
	PLAY += 2
ELSEIF CFLAG:582 > -6000
	PLAY += 3
ELSEIF CFLAG:582 > -9000
	PLAY += 4
ELSEIF CFLAG:582 > -12000
	PLAY += 5
ELSEIF CFLAG:582 > -16000
	PLAY += 6
ELSE
	PLAY += 7
ENDIF

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

DRAWLINE

IF TALENT:勇者になる前の生活 == 8
	;貴族
	PRINT 貴族の
ELSEIF TALENT:勇者になる前の生活 == 12
	;聖女
	PRINT 聖女の
ELSEIF TALENT:チャームポイント == 23
	;大きな尻
	PRINT 大きな尻の
ELSE
	;特に何もない場合髪色
	PRINTFORM %GET_LOOK_INFO(TARGET, "髪の色")%の
ENDIF

PRINTFORM %SAVESTR:TARGET%は
;売春中毒か淫乱
IF ABL:TARGET:37 == 1 || TALENT:TARGET:76 == 1
	PRINTFORM 性欲を抑えきれず
ELSEIF CFLAG:582 < -4000
	PRINTFORM 借金が膨らみ過ぎて
ELSE
	PRINTFORM 冒険資金が底をついて
ENDIF
IF MEN == 0
	PRINT 村の男
ELSEIF MEN == 1
	PRINT 冒険者の男
ELSEIF MEN == 2
	PRINT 村の少年
	;収入減
	PAY -= 10
ELSEIF MEN == 3
	PRINT 街の成金
	;収入ボーナス
	PAY += 20
ELSE
	PRINT 行商人の男
ENDIF
PRINTFORML を呼び寄せてフェラ売春した
PRINTFORMW {PLAY}回裏通りでペニスを咥えたようだ...

PRINTFORML %EXPNAME:22%+{PLAY}
PRINTFORML %EXPNAME:20%+{PLAY}
PRINTFORML %EXPNAME:74%+{PLAY}
PRINTFORMW %PALAMNAME:7%の珠+{PLAY}
IF TALENT:汚臭敏感
	;苦痛
	PRINTFORMW %PALAMNAME:9%の珠+{PLAY}
	JUEL:9 += PLAY
ENDIF
EXP:フェラ経験 += PLAY
EXP:精液経験 += PLAY
EXP:74 += PLAY
JUEL:7 += PLAY

PAY += PLAY * 50
SIF PAY <= 0
	PAY = 1
PRINTFORMW %SAVESTR:TARGET%は代金を{PAY}入手し,経験値を同量得た
EXP:80 += PAY
CFLAG:580 += PAY

PRINTW (カルマが減少しました:-1)
CALL KARMA, TARGET, -1

RETURN 1

;--------------------------------
@HEROINE_ANIMAL_SHOW
#DIM PLAY
#DIM PAY
;--------------------------------
;獣姦ショー出演

;調教対象が空だとダメ
SIF TARGET < 0
	RETURN 0

;ITEM:野良犬がないとダメ
;魔王様の犬とは違う犬だけど
;性癖フィルター用に
SIF ITEM:22 == 0
	RETURN 0

;処女やオトコだとダメ
SIF TALENT:0 || TALENT:122 == 1
	RETURN 0

;貞操帯だとダメ
SIF CFLAG:42 == 79 && (CFLAG:40 & 64)
	RETURN 0

;瀕死だとダメ
SIF BASE:0 < 500
	RETURN 0

PLAY = -3

;獣姦中毒
IF ABL:39 == 0
	PLAY -= 2
ELSEIF ABL:39 == 1
	PLAY -= 1
ELSEIF ABL:39 == 2
	PLAY += 0
ELSEIF ABL:39 == 3
	PLAY += 1
ELSEIF ABL:39 == 4
	PLAY += 2
ELSEIF ABL:39 == 5
	PLAY += 3
ELSEIF ABL:39 >= 6
	PLAY += 4
ENDIF

;動物耳で欲望ＬV３以上
SIF TALENT:124 && ABL:11 >= 3
	PLAY += 1

;かわいい動物が好きで欲望ＬV４以上
SIF  TALENT:317 == 12 && ABL:11 >= 4
	PLAY += 1

;獣姦経験が50以上
SIF EXP:56 >= 50
	PLAY += 2

;欲望ＬV5以上露出癖４以上で+1(下と合わせて+2)
SIF ABL:11 >= 5 && ABL:17 >= 4
	PLAY += 1
;欲望ＬV４以上露出癖３以上で+1
SIF ABL:11 >= 4 && ABL:17 >= 3
	PLAY += 1

;牝犬によるボーナス
SIF TALENT:136
	PLAY += 2

;カルマによる積極性
IF CFLAG:151 > 150
	PLAY -= 3
ELSEIF CFLAG:151 > 100
	PLAY -= 2
ELSEIF CFLAG:151 > 50
	PLAY -= 1
ELSEIF CFLAG:151 > 0
	;変動なし
ELSEIF CFLAG:151 > -50
	PLAY += 1
ELSEIF CFLAG:151 > -100
	PLAY += 2
ELSEIF CFLAG:151 > -150
	PLAY += 3
ELSE
	PLAY += 4
ENDIF

;借金による強制
IF CFLAG:582 >= 0
	PLAY -= 3
ELSEIF CFLAG:582 > -1000
	PLAY -= 2
ELSEIF CFLAG:582 > -2000
	PLAY -= 1
ELSEIF CFLAG:582 > -3000
	;変動なし
ELSEIF CFLAG:582 > -4000
	PLAY += 1
ELSEIF CFLAG:582 > -6000
	PLAY += 2
ELSEIF CFLAG:582 > -8000
	PLAY += 3
ELSEIF CFLAG:582 > -11000
	PLAY += 4
ELSEIF CFLAG:582 > -15000
	PLAY += 6
ELSEIF CFLAG:582 > -20000
	PLAY += 8
ELSEIF CFLAG:582 > -25000
	PLAY += 10
ELSE
	PLAY += 12
ENDIF


;回数が0以下なら終了
SIF PLAY <= 0
	RETURN 0

;プライド低い,解放,動物耳によるボーナス
SIF TALENT:17
	PLAY += 1
SIF TALENT:33
	PLAY += 1
SIF TALENT:124
	PLAY += 1

;プライド高い,自制心,抑圧,汚臭敏感によるペナルティ
SIF TALENT:15
	PLAY -= 1
SIF TALENT:20
	PLAY -= 1
SIF TALENT:32
	PLAY -= 1
SIF TALENT:62 && TALENT:64 == 0
	PLAY -= 2

;快感に素直,快感の否定
IF TALENT:70
	PLAY += 1
ELSEIF TALENT:71
	PLAY -= 2
ENDIF

;淫乱によるボーナス
SIF TALENT:76
	PLAY += 1

;牝犬によるボーナスその2
SIF TALENT:136
	TIMES PLAY , 1.50

;回数が0以下になっていたら終了
SIF PLAY <= 0
	RETURN 0

DRAWLINE
IF TALENT:勇者になる前の生活 == 8
	;貴族
	PRINT 貴族の
ELSEIF TALENT:勇者になる前の生活 == 12
	;聖女
	PRINT 聖女の
ELSEIF TALENT:チャームポイント == 23
	;大きな尻
	PRINT 大きな尻の
ELSE
	;特に何もない場合髪色
	PRINTFORM %GET_LOOK_INFO(TARGET, "髪の色")%の
ENDIF

PRINTFORM %SAVESTR:TARGET%は

IF TALENT:136
	;牝犬
	PRINTFORM 獣姦欲求を抑えきれず
ELSEIF ABL:TARGET:37 == 1 || TALENT:TARGET:76 == 1
	;売春中毒か淫乱
	PRINTFORM 性欲を抑えきれず
ELSEIF CFLAG:582 < -4000
	PRINTFORM 借金が膨らみ過ぎて
ELSE
	PRINTFORM 冒険資金が底をついて
ENDIF
PRINTFORML 獣姦ショ-に出演することになったようだ......
PRINTFORMW {PLAY}回犬と交尾する姿を観客に晒したらしい
;獣姦経験
PRINTFORML %EXPNAME:56%+{PLAY}
PRINTFORML %EXPNAME:0%+{PLAY}
PRINTFORML %EXPNAME:5%+{PLAY}
EXP:56 += PLAY
EXP:0 += PLAY
EXP:5 += PLAY

;珠経験
PRINTFORML %PALAMNAME:1%の珠+{PLAY*200}
PRINTFORML %PALAMNAME:6%の珠+{PLAY*300}
PRINTFORMW %PALAMNAME:8%の珠+{PLAY*200}
JUEL:1 += PLAY*200
JUEL:6 += PLAY*300
JUEL:8 += PLAY*200

PAY += PLAY * 5000
SIF PAY <= 0
	PAY = 1
PRINTFORMW %SAVESTR:TARGET%は出演料を{PAY}入手し,経験値を{PLAY * 100}得た
EXP:80 += PLAY * 100
CFLAG:580 += PAY

PRINTW (カルマが減少しました:-2)
CALL KARMA, TARGET, -2

RETURN 1

[SKIPEND]


