2015/12/19

eramaou0.470用カルマ効果拡張パッチ

バグあったらごめんなさい
eramaouの活動拠点にはいない余所者なのでサポート等は無いものと思ってください



改造内容
・魔の誘惑の成功率の変更
　勇者のカルマと残り体力、残り気力、各種ABLや刻印が成功率に影響するように
　平常時の難易度は高くなりましたが弱ったところにつけ込むといい感じに負けてくれます
　えろトラップでABLや刻印をつけても効果があるよ
　また、誘惑に負けるとカルマが下がり、断ち切るとカルマが上昇します

・金銭感覚にカルマが関連するよう変更
　一度の借金返済額がカルマに連動して変動するように
　またPTのカルマと借金金額に応じて浅いフロアを探索するように
　（要調整、深層に来にくくなってしまった）

・売春システムの大改造
　処理内容を大幅に変更、中毒もちか借金まみれでもない限りはそうそう売春しませぬ
　実行確率や代金が勇者の能力や売春内容に応じて変化するように
　おおまかに　高カルマ＝高料金、低頻度　低カルマ＝低料金、高頻度
　追加要素として「手淫売春」「ダンジョン内フェラ売春」「街中でのレズ売春」を追加
　また、街中売春でも一応は地の文の呼び出しをかけるように
　（追加したものについては現状では文章がありません）

・勇者が宿で自慰をするように
　売春改造の余波
　たぶん低確率

・地の文追加
　売春改造の余波
　獣姦系は性癖的にむりぽ

・行商人トラップの効果変更
　手持ち資金ではなく借金を操作するように
　勇者個人のおさいふ事情の把握とかやってらんねーと思った
　高カルマ勇者を売春に追い込むためのやっつけ仕事



不安点
・ダンジョン周りの挙動をろくに理解していない、どっか齟齬とか出てくるかも・・・
・バランスもあんま確認してない、勇者側のリソース（資金）管理はどうなんでしょ
・全体にカルマ減少の効果が強すぎる（でも魔王さまだしこれで良いような気もする）

ライセンス
・配布・改造・流用、好きにしてください
・でも、その際のサポートは自分でやってね

※　R-18全般の常識的な取り扱いとして例えば以下のような事はやめて下さい

・未成年者がいっぱいいる場所で広める
・R-18以外のモノをメインに扱ってる場所で取り上げる




作者さん向け情報
・関数@DUNGEON_BITCHの使用変数の変更についての覚書

一文字変数はできる限り削減する方針で改造しました
なにか問題が出たらごめんなさい

一文字変数A
使用している形跡がなく削除

一文字変数N
使用している形跡がなく削除
レズ売春関数@DUNGEON_LESまわりでの使用を確認
呼び出し前に初期化→関数内に代入処理が無いまま参照→関数終了後にRESULTを代入
こんな流れでレズ売春処理内部では死に分岐になっていた
憶測だがもともとは自慰処理でレズプレイを思い出す分岐でも作っていたのだろうか
他で使っているとも思えないため削除

一文字変数M
使用している形跡がなく削除
内職処理での一時変数利用として一文字変数Mを使用していたがそちらについては
以降の処理で必要になるとは思えなかったためLOCALで置き換えた

関数@HEROINE_BITCHについては一文字変数はたぶん未使用だった



・バグ報告：シュート落下によるフロア更新がおかしい
　CFLAG:ARG:501の更新タイミングの問題と思うが@DUNGEONが理解できず対処できなかった
　確認お願いします
　
　発生した例
　１．PTでリーダーではない、なおかつリーダーより登録番号の大きいキャラaがシュートにひっかかる
　２．シュートの効果でPTから外れる
　３．SYSTEM.ERBの@EVENTTURNENDから呼び出しがかかってaをリーダーとしたソロパーティの侵攻が始まる
　４．この時、シュートによる階層更新がかかっておらず１と同じ階層（この時点でおかしい）
　５．シュートが発動するも勇者aは深層に落下しなかった（シュート落下による階層移動のフラグが上書きされた？憶測）
　６．全PTの行動終了の後、勇者aが元のPTに加入
